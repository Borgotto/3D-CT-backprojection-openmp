\doxysection{backprojector.\+c}
\hypertarget{backprojector_8c_source}{}\label{backprojector_8c_source}\index{backprojector.c@{backprojector.c}}
\mbox{\hyperlink{backprojector_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00001}00001\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00023}00023\ \textcolor{preprocessor}{\#include\ <stdio.h>}\ \ \ \ \ \ \textcolor{comment}{//\ printf,\ perror}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00024}00024\ \textcolor{preprocessor}{\#include\ <stdlib.h>}\ \ \ \ \ \textcolor{comment}{//\ malloc,\ calloc,\ free}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00025}00025\ \textcolor{preprocessor}{\#include\ <stdbool.h>}\ \ \ \ \textcolor{comment}{//\ bool,\ true,\ false}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00026}00026\ \textcolor{preprocessor}{\#include\ <string.h>}\ \ \ \ \ \textcolor{comment}{//\ strcmp,\ strstr}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00027}00027\ \textcolor{preprocessor}{\#include\ <math.h>}\ \ \ \ \ \ \ \textcolor{comment}{//\ sinl,\ cosl}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00028}00028\ \textcolor{preprocessor}{\#include\ <float.h>}\ \ \ \ \ \ \textcolor{comment}{//\ DBL\_MAX,\ DBL\_MIN}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00029}00029\ \textcolor{preprocessor}{\#include\ <assert.h>}\ \ \ \ \ \textcolor{comment}{//\ assert}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00030}00030\ \textcolor{preprocessor}{\#include\ <unistd.h>}\ \ \ \ \ \textcolor{comment}{//\ isatty}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00031}00031\ \textcolor{preprocessor}{\#include\ <omp.h>}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00033}00033\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{backprojector_8h}{backprojector.h}}"{}}\ \textcolor{comment}{//\ All\ of\ the\ constants\ and\ structs\ needed\ for\ the\ backprojection\ algorithm}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00034}00034\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fileReader_8h}{fileReader.h}}"{}}\ \ \ \ \textcolor{comment}{//\ Functions\ to\ read\ the\ projection\ images\ from\ the\ file}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00035}00035\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fileWriter_8h}{fileWriter.h}}"{}}\ \ \ \ \textcolor{comment}{//\ Functions\ to\ write\ the\ reconstructed\ 3D\ object\ to\ a\ file}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00036}00036\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00038}00038\ \textcolor{comment}{//\ Cache\ the\ sin\ and\ cos\ values\ of\ the\ angles\ to\ avoid\ recalculating\ them}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00039}\mbox{\hyperlink{backprojector_8c_a79e6ecbf5ed19cbd5f93888de8cc6656}{00039}}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{backprojector_8c_ad60e8e0f9959c12c836ebc81a0a6bb24}{sinTable}}[\mbox{\hyperlink{backprojector_8h_a5d8f246b13887f17dd67a8ce2cbdaea3}{N\_THETA}}],\ \mbox{\hyperlink{backprojector_8c_a79e6ecbf5ed19cbd5f93888de8cc6656}{cosTable}}[\mbox{\hyperlink{backprojector_8h_a5d8f246b13887f17dd67a8ce2cbdaea3}{N\_THETA}}];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00040}00040\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00041}00041\ \textcolor{comment}{//\ Cache\ the\ first\ and\ last\ plane\ positions\ for\ each\ axis}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00042}\mbox{\hyperlink{backprojector_8c_a580fa2a1266bb48c33b07de86029e075}{00042}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{backprojector_8c_a580fa2a1266bb48c33b07de86029e075}{firstPlane}}[3],\ \mbox{\hyperlink{backprojector_8c_ab92865ce9fc376ad61faa449e605310c}{lastPlane}}[3];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00044}\mbox{\hyperlink{backprojector_8c_a6a3745a608949257cc9c8dcd35bb6e72}{00044}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{backprojector_8c_a6a3745a608949257cc9c8dcd35bb6e72}{initTables}}()\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00045}00045\ \ \ \ \ \textcolor{comment}{//\ Calculate\ sin\ and\ cos\ values\ for\ the\ angle\ of\ this\ projection}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00046}00046\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{backprojector_8h_a5d8f246b13887f17dd67a8ce2cbdaea3}{N\_THETA}};\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00047}00047\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ angle\ =\ \mbox{\hyperlink{backprojector_8h_a8300bbcd56f47545962fcf22d934e24b}{AP}}\ /\ 2\ +\ i\ *\ \mbox{\hyperlink{backprojector_8h_a16e0a6585d892aa03b6c0102ddfd0b75}{STEP\_ANGLE}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00048}00048\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{double}\ rad\ =\ angle\ *\ \mbox{\hyperlink{backprojector_8h_ae71449b1cc6e6250b91f539153a7a0d3}{M\_PI}}\ /\ 180;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00049}00049\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{backprojector_8c_ad60e8e0f9959c12c836ebc81a0a6bb24}{sinTable}}[i]\ =\ sinl(rad);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00050}00050\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{backprojector_8c_a79e6ecbf5ed19cbd5f93888de8cc6656}{cosTable}}[i]\ =\ cosl(rad);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00051}00051\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00052}00052\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00053}00053\ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ first\ and\ last\ plane\ positions\ for\ each\ axis}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00054}00054\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ =\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21a58833a3110c570fb05130d40c365d1e4}{X}};\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ <=\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21aa70478ce277ffc322f8e1e3418e07355}{Z}};\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}++)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00055}00055\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{backprojector_8c_a580fa2a1266bb48c33b07de86029e075}{firstPlane}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ =\ -\/(\mbox{\hyperlink{backprojector_8h_add180005148d2dcd6ce86521114a9bf4}{VOXEL\_SIZE}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ *\ \mbox{\hyperlink{backprojector_8h_a6b57404d7c782a229aa58d85bb420765}{N\_VOXELS}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ /\ 2;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00056}00056\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{backprojector_8c_ab92865ce9fc376ad61faa449e605310c}{lastPlane}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ =\ (\mbox{\hyperlink{backprojector_8h_add180005148d2dcd6ce86521114a9bf4}{VOXEL\_SIZE}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ *\ \mbox{\hyperlink{backprojector_8h_a6b57404d7c782a229aa58d85bb420765}{N\_VOXELS}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ /\ 2;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00057}00057\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00058}00058\ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00059}00059\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00060}00060\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00061}00061\ \textcolor{comment}{/*******************************************}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00062}00062\ \textcolor{comment}{*\ Functions\ to\ calculate\ 3D\ space\ positions}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00063}00063\ \textcolor{comment}{********************************************/}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00065}\mbox{\hyperlink{backprojector_8c_a081dea4548f6635b8bcf377386c33226}{00065}}\ \mbox{\hyperlink{unionpoint3D}{point3D}}\ \mbox{\hyperlink{backprojector_8c_a081dea4548f6635b8bcf377386c33226}{getSourcePosition}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ projectionIndex)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00066}00066\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{unionpoint3D}{point3D}})\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00067}00067\ \ \ \ \ \ \ \ \ .x\ =\ -\/\mbox{\hyperlink{backprojector_8c_ad60e8e0f9959c12c836ebc81a0a6bb24}{sinTable}}[projectionIndex]\ *\ \mbox{\hyperlink{backprojector_8h_a539f7700c3182a8cfba81550da7410a3}{DOS}},}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00068}00068\ \ \ \ \ \ \ \ \ .y\ =\ \mbox{\hyperlink{backprojector_8c_a79e6ecbf5ed19cbd5f93888de8cc6656}{cosTable}}[projectionIndex]\ *\ \mbox{\hyperlink{backprojector_8h_a539f7700c3182a8cfba81550da7410a3}{DOS}},}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00069}00069\ \ \ \ \ \ \ \ \ .z\ =\ 0\ \textcolor{comment}{//\ 0\ because\ the\ source\ is\ perpendicular\ to\ the\ center\ of\ the\ detector}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00070}00070\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00071}00071\ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00072}00072\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00073}\mbox{\hyperlink{backprojector_8c_a44ba7f13100e9b59778aaa69cf1b6237}{00073}}\ \mbox{\hyperlink{unionpoint3D}{point3D}}\ \mbox{\hyperlink{backprojector_8c_a44ba7f13100e9b59778aaa69cf1b6237}{getPixelPosition}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structprojection}{projection}}*\ \mbox{\hyperlink{structprojection}{projection}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ row,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ col)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00074}00074\ \ \ \ \ \textcolor{comment}{//\ This\ is\ the\ distance\ from\ the\ center\ of\ the\ detector\ to\ the\ top-\/left\ pixel's\ center}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00075}00075\ \ \ \ \ \textcolor{comment}{//\ it's\ used\ to\ calculate\ the\ center\ position\ of\ subsequent\ pixels}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00076}00076\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ dFirstPixel\ =\ \mbox{\hyperlink{structprojection}{projection}}-\/>\mbox{\hyperlink{structprojection_af86af3a77d3a5708622992a0873c4880}{nSidePixels}}\ *\ \mbox{\hyperlink{backprojector_8h_a139400013c795fbea5304c0bdbe51591}{PIXEL\_SIZE}}\ /\ 2\ -\/\ \mbox{\hyperlink{backprojector_8h_a139400013c795fbea5304c0bdbe51591}{PIXEL\_SIZE}}\ /\ 2;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00077}00077\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ sinAngle\ =\ \mbox{\hyperlink{backprojector_8c_ad60e8e0f9959c12c836ebc81a0a6bb24}{sinTable}}[\mbox{\hyperlink{structprojection}{projection}}-\/>\mbox{\hyperlink{structprojection_a3a6f422df5e5f4fa0b268f6530a1f091}{index}}];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00078}00078\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ cosAngle\ =\ \mbox{\hyperlink{backprojector_8c_a79e6ecbf5ed19cbd5f93888de8cc6656}{cosTable}}[\mbox{\hyperlink{structprojection}{projection}}-\/>\mbox{\hyperlink{structprojection_a3a6f422df5e5f4fa0b268f6530a1f091}{index}}];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00079}00079\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00080}00080\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{unionpoint3D}{point3D}})\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00081}00081\ \ \ \ \ \ \ \ \ .x\ =\ (\mbox{\hyperlink{backprojector_8h_aa7e4d96037f891910b5dcf661c5fa8e6}{DOD}}\ *\ sinAngle)\ +\ cosAngle\ *\ (-\/dFirstPixel\ +\ col\ *\ \mbox{\hyperlink{backprojector_8h_a139400013c795fbea5304c0bdbe51591}{PIXEL\_SIZE}}),}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00082}00082\ \ \ \ \ \ \ \ \ .y\ =\ -\/\mbox{\hyperlink{backprojector_8h_aa7e4d96037f891910b5dcf661c5fa8e6}{DOD}}\ *\ cosAngle\ +\ sinAngle\ *\ (-\/dFirstPixel\ +\ col\ *\ \mbox{\hyperlink{backprojector_8h_a139400013c795fbea5304c0bdbe51591}{PIXEL\_SIZE}}),}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00083}00083\ \ \ \ \ \ \ \ \ .z\ =\ -\/dFirstPixel\ +\ row\ *\ \mbox{\hyperlink{backprojector_8h_a139400013c795fbea5304c0bdbe51591}{PIXEL\_SIZE}}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00084}00084\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00085}00085\ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00087}\mbox{\hyperlink{backprojector_8c_a96c75e5ea7fdb7390df28cf46090b065}{00087}}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ \mbox{\hyperlink{backprojector_8c_a96c75e5ea7fdb7390df28cf46090b065}{getParallelAxis}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{unionray}{ray}}\ \mbox{\hyperlink{unionray}{ray}})\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00088}00088\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{unionpoint3D}{point3D}}\ source\ =\ \mbox{\hyperlink{unionray}{ray}}.\mbox{\hyperlink{unionray_abc22f3064aafb24fe6835d6058e7b9ba}{source}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00089}00089\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{unionpoint3D}{point3D}}\ pixel\ =\ \mbox{\hyperlink{unionray}{ray}}.\mbox{\hyperlink{unionray_a766cff5c6d0927c7d775141d6d1806c0}{pixel}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00090}00090\ \ \ \ \ \textcolor{keywordflow}{if}\ (source.\mbox{\hyperlink{unionpoint3D_a4adcb38dc857422d2c3b2aff81e58251}{x}}\ ==\ pixel.\mbox{\hyperlink{unionpoint3D_a4adcb38dc857422d2c3b2aff81e58251}{x}})\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00091}00091\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21a58833a3110c570fb05130d40c365d1e4}{X}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00092}00092\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (source.\mbox{\hyperlink{unionpoint3D_a9b924ec7cf9675336e8785f8339aafde}{y}}\ ==\ pixel.\mbox{\hyperlink{unionpoint3D_a9b924ec7cf9675336e8785f8339aafde}{y}})\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00093}00093\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21a5596231eabd6cf29050967d5ac83ad84}{Y}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00094}00094\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (source.\mbox{\hyperlink{unionpoint3D_a10a5c678a54507b798c774c8cee1a0e0}{z}}\ ==\ pixel.\mbox{\hyperlink{unionpoint3D_a10a5c678a54507b798c774c8cee1a0e0}{z}})\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00095}00095\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21aa70478ce277ffc322f8e1e3418e07355}{Z}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00096}00096\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00097}00097\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21ac157bdf0b85a40d2619cbc8bc1ae5fe2}{NONE}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00098}00098\ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00099}00099\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00100}\mbox{\hyperlink{backprojector_8c_aff0f271395d320a9c9856d4c12e4febb}{00100}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{backprojector_8c_aff0f271395d320a9c9856d4c12e4febb}{getPlanePosition}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ index)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00101}00101\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/((\mbox{\hyperlink{backprojector_8h_add180005148d2dcd6ce86521114a9bf4}{VOXEL\_SIZE}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ *\ \mbox{\hyperlink{backprojector_8h_a6b57404d7c782a229aa58d85bb420765}{N\_VOXELS}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ /\ 2)\ +\ index\ *\ \mbox{\hyperlink{backprojector_8h_add180005148d2dcd6ce86521114a9bf4}{VOXEL\_SIZE}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00102}00102\ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00103}00103\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00104}00104\ \textcolor{comment}{/*********************************************}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00105}00105\ \textcolor{comment}{*\ Functions\ defined\ in\ the\ Siddon's\ algorithm}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00106}00106\ \textcolor{comment}{**********************************************/}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00107}00107\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00108}\mbox{\hyperlink{backprojector_8c_ae8384b3bc5b85feb8e1c1a498bbff052}{00108}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{backprojector_8c_ae8384b3bc5b85feb8e1c1a498bbff052}{getSidesIntersections}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{unionray}{ray}}\ \mbox{\hyperlink{unionray}{ray}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ parallelTo,\ \textcolor{keywordtype}{double}\ intersections[3][2])\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00109}00109\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{unionpoint3D}{point3D}}\ source\ =\ \mbox{\hyperlink{unionray}{ray}}.\mbox{\hyperlink{unionray_abc22f3064aafb24fe6835d6058e7b9ba}{source}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00110}00110\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{unionpoint3D}{point3D}}\ pixel\ =\ \mbox{\hyperlink{unionray}{ray}}.\mbox{\hyperlink{unionray_a766cff5c6d0927c7d775141d6d1806c0}{pixel}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00111}00111\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ =\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21a58833a3110c570fb05130d40c365d1e4}{X}};\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ <=\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21aa70478ce277ffc322f8e1e3418e07355}{Z}};\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}++)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00112}00112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ ==\ parallelTo)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};\ \textcolor{comment}{//\ Skip\ the\ axis\ that\ the\ ray\ is\ parallel\ to}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00114}00114\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00115}00115\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00116}00116\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ entry\ and\ exit\ points\ of\ the\ ray\ with\ the\ planes\ of\ this\ axis}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00117}00117\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Siddon's\ algorithm,\ equation\ (4)}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00118}00118\ \ \ \ \ \ \ \ \ intersections[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}][0]\ =\ (\mbox{\hyperlink{backprojector_8c_a580fa2a1266bb48c33b07de86029e075}{firstPlane}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ /\ (pixel.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00119}00119\ \ \ \ \ \ \ \ \ intersections[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}][1]\ =\ (\mbox{\hyperlink{backprojector_8c_ab92865ce9fc376ad61faa449e605310c}{lastPlane}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ /\ (pixel.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00120}00120\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00121}00121\ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00123}\mbox{\hyperlink{backprojector_8c_a0e38a3847dec2b2e3c40870d8b938e19}{00123}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{backprojector_8c_a0e38a3847dec2b2e3c40870d8b938e19}{getAMin}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ parallelTo,\ \textcolor{keywordtype}{double}\ intersections[3][2])\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00124}00124\ \ \ \ \ \textcolor{keywordtype}{double}\ aMin\ =\ 0.0;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00125}00125\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ =\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21a58833a3110c570fb05130d40c365d1e4}{X}};\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ <=\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21aa70478ce277ffc322f8e1e3418e07355}{Z}};\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}++)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00126}00126\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ ==\ parallelTo)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00127}00127\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};\ \textcolor{comment}{//\ Skip\ the\ axis\ that\ the\ ray\ is\ parallel\ to}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00128}00128\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00129}00129\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00130}00130\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Siddon's\ algorithm,\ equation\ (5)}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00131}00131\ \ \ \ \ \ \ \ \ aMin\ =\ fmax(aMin,\ fmin(intersections[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}][0],\ intersections[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}][1]));}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00132}00132\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00133}00133\ \ \ \ \ \textcolor{keywordflow}{return}\ aMin;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00134}00134\ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00135}00135\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00136}\mbox{\hyperlink{backprojector_8c_a5dad3fd7c1d04e6eeca36364d14c1245}{00136}}\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{backprojector_8c_a5dad3fd7c1d04e6eeca36364d14c1245}{getAMax}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ parallelTo,\ \textcolor{keywordtype}{double}\ intersections[3][2])\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00137}00137\ \ \ \ \ \textcolor{keywordtype}{double}\ aMax\ =\ 1.0;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00138}00138\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ =\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21a58833a3110c570fb05130d40c365d1e4}{X}};\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ <=\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21aa70478ce277ffc322f8e1e3418e07355}{Z}};\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}++)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00139}00139\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ ==\ parallelTo)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};\ \textcolor{comment}{//\ Skip\ the\ axis\ that\ the\ ray\ is\ parallel\ to}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00141}00141\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00142}00142\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00143}00143\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Siddon's\ algorithm,\ equation\ (5)}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00144}00144\ \ \ \ \ \ \ \ \ aMax\ =\ fmin(aMax,\ fmax(intersections[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}][0],\ intersections[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}][1]));}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00145}00145\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00146}00146\ \ \ \ \ \textcolor{keywordflow}{return}\ aMax;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00147}00147\ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00148}00148\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00149}\mbox{\hyperlink{backprojector_8c_abb728284497ed8524b8acc57996e6f0d}{00149}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{backprojector_8c_abb728284497ed8524b8acc57996e6f0d}{getPlanesRanges}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{unionray}{ray}}\ \mbox{\hyperlink{unionray}{ray}},\ \mbox{\hyperlink{unionrange}{range}}\ planesIndexes[3],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ aMin,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ aMax,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ parallelTo)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00150}00150\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{unionpoint3D}{point3D}}\ source\ =\ \mbox{\hyperlink{unionray}{ray}}.\mbox{\hyperlink{unionray_abc22f3064aafb24fe6835d6058e7b9ba}{source}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00151}00151\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{unionpoint3D}{point3D}}\ pixel\ =\ \mbox{\hyperlink{unionray}{ray}}.\mbox{\hyperlink{unionray_a766cff5c6d0927c7d775141d6d1806c0}{pixel}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00152}00152\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ =\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21a58833a3110c570fb05130d40c365d1e4}{X}};\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ <=\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21aa70478ce277ffc322f8e1e3418e07355}{Z}};\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}++)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00153}00153\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Siddon's\ algorithm,\ equation\ (6)}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00154}00154\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ minIndex,\ maxIndex;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00155}00155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pixel.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ >=\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \ \ \ minIndex\ =\ \mbox{\hyperlink{backprojector_8h_ae9e413a79eae2da136d9f7c30775fac3}{N\_PLANES}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ ceil((\mbox{\hyperlink{backprojector_8c_ab92865ce9fc376ad61faa449e605310c}{lastPlane}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ aMin\ *\ (pixel.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ /\ \mbox{\hyperlink{backprojector_8h_add180005148d2dcd6ce86521114a9bf4}{VOXEL\_SIZE}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \ \ \ maxIndex\ =\ floor((source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ +\ aMax\ *\ (pixel.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ -\/\ \mbox{\hyperlink{backprojector_8c_a580fa2a1266bb48c33b07de86029e075}{firstPlane}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ /\ \mbox{\hyperlink{backprojector_8h_add180005148d2dcd6ce86521114a9bf4}{VOXEL\_SIZE}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00158}00158\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00159}00159\ \ \ \ \ \ \ \ \ \ \ \ \ minIndex\ =\ \mbox{\hyperlink{backprojector_8h_ae9e413a79eae2da136d9f7c30775fac3}{N\_PLANES}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ ceil((\mbox{\hyperlink{backprojector_8c_ab92865ce9fc376ad61faa449e605310c}{lastPlane}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ aMax\ *\ (pixel.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ /\ \mbox{\hyperlink{backprojector_8h_add180005148d2dcd6ce86521114a9bf4}{VOXEL\_SIZE}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00160}00160\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ verify\ if\ '1\ +'\ is\ needed\ at\ the\ beginning\ of\ the\ next\ line}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ maxIndex\ =\ floor((source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ +\ aMin\ *\ (pixel.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ -\/\ \mbox{\hyperlink{backprojector_8c_a580fa2a1266bb48c33b07de86029e075}{firstPlane}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ /\ \mbox{\hyperlink{backprojector_8h_add180005148d2dcd6ce86521114a9bf4}{VOXEL\_SIZE}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00162}00162\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00163}00163\ \ \ \ \ \ \ \ \ planesIndexes[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ =\ (\mbox{\hyperlink{backprojector_8h_a49a5be5971db30b47d2564ab77552eaa}{range}})\{.min=minIndex,\ .max=maxIndex\};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00164}00164\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00165}00165\ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00166}00166\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00167}\mbox{\hyperlink{backprojector_8c_ae6ca17545d3e55eadcfdfe51b4b5e11c}{00167}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{backprojector_8c_ae6ca17545d3e55eadcfdfe51b4b5e11c}{getAllIntersections}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{unionray}{ray}}\ \mbox{\hyperlink{unionray}{ray}},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{unionrange}{range}}\ planesRanges[3],\ \textcolor{keywordtype}{double}*\ a[3])\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00168}00168\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{unionpoint3D}{point3D}}\ source\ =\ \mbox{\hyperlink{unionray}{ray}}.\mbox{\hyperlink{unionray_abc22f3064aafb24fe6835d6058e7b9ba}{source}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00169}00169\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{unionpoint3D}{point3D}}\ pixel\ =\ \mbox{\hyperlink{unionray}{ray}}.\mbox{\hyperlink{unionray_a766cff5c6d0927c7d775141d6d1806c0}{pixel}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00170}00170\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ =\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21a58833a3110c570fb05130d40c365d1e4}{X}};\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ <=\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21aa70478ce277ffc322f8e1e3418e07355}{Z}};\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}++)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00171}00171\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ minIndex\ =\ planesRanges[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}].\mbox{\hyperlink{unionrange_ac44f344c608da635b1982be4e412ba01}{min}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00172}00172\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ maxIndex\ =\ planesRanges[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}].\mbox{\hyperlink{unionrange_a4b9f4703bc318f6f7cd0f1cb50e113f1}{max}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00173}00173\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00174}00174\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (minIndex\ >=\ maxIndex)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00175}00175\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00176}00176\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00177}00177\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00178}00178\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Siddon's\ algorithm,\ equation\ (7)}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00179}00179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pixel.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ >\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00180}00180\ \ \ \ \ \ \ \ \ \ \ \ \ a[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}][0]\ =\ (\mbox{\hyperlink{backprojector_8c_aff0f271395d320a9c9856d4c12e4febb}{getPlanePosition}}(minIndex,\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}})\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ /\ (pixel.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00181}00181\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ maxIndex\ -\/\ minIndex;\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00182}00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}][i]\ =\ a[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}][i\ -\/\ 1]\ +\ \mbox{\hyperlink{backprojector_8h_add180005148d2dcd6ce86521114a9bf4}{VOXEL\_SIZE}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ /\ (pixel.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00183}00183\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00184}00184\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (pixel.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ <\ 0)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00185}00185\ \ \ \ \ \ \ \ \ \ \ \ \ a[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}][0]\ =\ (\mbox{\hyperlink{backprojector_8c_aff0f271395d320a9c9856d4c12e4febb}{getPlanePosition}}(maxIndex,\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}})\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}])\ /\ (pixel.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00186}00186\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ maxIndex\ -\/\ minIndex;\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00187}00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ check\ if\ '+'\ or\ '-\/'\ is\ correct\ here\ (it's\ '+'\ in\ Siddon's\ algorithm,\ but\ '-\/'\ seems\ to\ be\ correct)}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00188}00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}][i]\ =\ a[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}][i\ -\/\ 1]\ -\/\ \mbox{\hyperlink{backprojector_8h_add180005148d2dcd6ce86521114a9bf4}{VOXEL\_SIZE}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ /\ (pixel.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]\ -\/\ source.\mbox{\hyperlink{unionpoint3D_afd5d0c16099d1ab160ffc0b20ba2ea71}{coordinates}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}]);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00189}00189\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00190}00190\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00191}00191\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00192}00192\ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00193}00193\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00194}\mbox{\hyperlink{backprojector_8c_a6616c0957bffb44f16fb54c48f3f3f05}{00194}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{backprojector_8c_a6616c0957bffb44f16fb54c48f3f3f05}{mergeIntersections}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ aX[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ aY[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ aZ[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ aXSize,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ aYSize,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ aZSize,\ \textcolor{keywordtype}{double}\ aMerged[])\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00195}00195\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i\ =\ 0,\ j\ =\ 0,\ k\ =\ 0,\ l\ =\ 0;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00196}00196\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00197}00197\ \ \ \ \ \textcolor{keywordflow}{while}\ (i\ <\ aXSize\ \&\&\ j\ <\ aYSize\ \&\&\ k\ <\ aZSize)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00198}00198\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (aX[i]\ <=\ aY[j]\ \&\&\ aX[i]\ <=\ aZ[k])\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00199}00199\ \ \ \ \ \ \ \ \ \ \ \ \ aMerged[l++]\ =\ aX[i++];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00200}00200\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (aY[j]\ <=\ aX[i]\ \&\&\ aY[j]\ <=\ aZ[k])\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00201}00201\ \ \ \ \ \ \ \ \ \ \ \ \ aMerged[l++]\ =\ aY[j++];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00202}00202\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00203}00203\ \ \ \ \ \ \ \ \ \ \ \ \ aMerged[l++]\ =\ aZ[k++];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00204}00204\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00205}00205\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00206}00206\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00207}00207\ \ \ \ \ \textcolor{keywordflow}{while}\ (i\ <\ aXSize\ \&\&\ j\ <\ aYSize)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00208}00208\ \ \ \ \ \ \ \ \ aMerged[l++]\ =\ (aX[i]\ <=\ aY[j])\ ?\ aX[i++]\ :\ aY[j++];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00209}00209\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00210}00210\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00211}00211\ \ \ \ \ \textcolor{keywordflow}{while}\ (j\ <\ aYSize\ \&\&\ k\ <\ aZSize)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00212}00212\ \ \ \ \ \ \ \ \ aMerged[l++]\ =\ (aY[j]\ <=\ aZ[k])\ ?\ aY[j++]\ :\ aZ[k++];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00213}00213\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00214}00214\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00215}00215\ \ \ \ \ \textcolor{keywordflow}{while}\ (i\ <\ aXSize\ \&\&\ k\ <\ aZSize)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00216}00216\ \ \ \ \ \ \ \ \ aMerged[l++]\ =\ (aX[i]\ <=\ aZ[k])\ ?\ aX[i++]\ :\ aZ[k++];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00217}00217\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00218}00218\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00219}00219\ \ \ \ \ \textcolor{keywordflow}{while}\ (i\ <\ aXSize)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00220}00220\ \ \ \ \ \ \ \ \ aMerged[l++]\ =\ aX[i++];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00221}00221\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00222}00222\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00223}00223\ \ \ \ \ \textcolor{keywordflow}{while}\ (j\ <\ aYSize)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00224}00224\ \ \ \ \ \ \ \ \ aMerged[l++]\ =\ aY[j++];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00225}00225\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00226}00226\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00227}00227\ \ \ \ \ \textcolor{keywordflow}{while}\ (k\ <\ aZSize)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00228}00228\ \ \ \ \ \ \ \ \ aMerged[l++]\ =\ aZ[k++];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00229}00229\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00230}00230\ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00231}00231\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00232}\mbox{\hyperlink{backprojector_8c_a973af40d863ad969ee5362184f7656a8}{00232}}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{backprojector_8c_a973af40d863ad969ee5362184f7656a8}{isArraySorted}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ array[],\ \textcolor{keywordtype}{int}\ size)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00233}00233\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ size;\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00234}00234\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (array[i]\ <\ array[i\ -\/\ 1])\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00235}00235\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00236}00236\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00237}00237\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00238}00238\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00239}00239\ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00240}00240\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00241}\mbox{\hyperlink{backprojector_8c_a0dff3e6286ee3ee9b7e74f9a9ad4f2ec}{00241}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{backprojector_8c_a0dff3e6286ee3ee9b7e74f9a9ad4f2ec}{computeAbsorption}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{unionray}{ray}}\ \mbox{\hyperlink{unionray}{ray}},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ a[],\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ lenA,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ pixelAbsorptionValue,\ \textcolor{keywordtype}{double}*\ coefficients)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00242}00242\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{unionpoint3D}{point3D}}\ source\ =\ \mbox{\hyperlink{unionray}{ray}}.\mbox{\hyperlink{unionray_abc22f3064aafb24fe6835d6058e7b9ba}{source}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00243}00243\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{unionpoint3D}{point3D}}\ pixel\ =\ \mbox{\hyperlink{unionray}{ray}}.\mbox{\hyperlink{unionray_a766cff5c6d0927c7d775141d6d1806c0}{pixel}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00244}00244\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00245}00245\ \ \ \ \ \textcolor{comment}{//\ distance\ between\ the\ source(1)\ and\ the\ pixel(2),\ Siddon's\ algorithm,\ equation\ (11)}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00246}00246\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ dx\ =\ pixel.\mbox{\hyperlink{unionpoint3D_a4adcb38dc857422d2c3b2aff81e58251}{x}}\ -\/\ source.\mbox{\hyperlink{unionpoint3D_a4adcb38dc857422d2c3b2aff81e58251}{x}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00247}00247\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ dy\ =\ pixel.\mbox{\hyperlink{unionpoint3D_a9b924ec7cf9675336e8785f8339aafde}{y}}\ -\/\ source.\mbox{\hyperlink{unionpoint3D_a9b924ec7cf9675336e8785f8339aafde}{y}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00248}00248\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ dz\ =\ pixel.\mbox{\hyperlink{unionpoint3D_a10a5c678a54507b798c774c8cee1a0e0}{z}}\ -\/\ source.\mbox{\hyperlink{unionpoint3D_a10a5c678a54507b798c774c8cee1a0e0}{z}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00249}00249\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ d12\ =\ sqrt(dx\ *\ dx\ +\ dy\ *\ dy\ +\ dz\ *\ dz);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00250}00250\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00251}00251\ \ \ \ \ \textcolor{comment}{//\ TODO:\ this\ needs\ to\ be\ optimized,\ see\ if\ it's\ possible\ to\ use\ SIMD\ instructions}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00252}00252\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ lenA;\ i\ ++)\{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00253}00253\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Siddon's\ algorithm,\ equation\ (10)}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00254}00254\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ segmentLength\ =\ d12\ *\ (a[i]\ -\/\ a[i-\/1]);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00255}00255\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Siddon's\ algorithm,\ equation\ (13)}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00256}00256\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ aMid\ =\ (a[i]\ +\ a[i-\/1])\ /\ 2;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00257}00257\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00258}00258\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ voxel\ indices\ that\ the\ ray\ intersects}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00259}00259\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Siddon's\ algorithm,\ equation\ (12)}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00260}00260\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ voxelX\ =\ ((source.\mbox{\hyperlink{unionpoint3D_a4adcb38dc857422d2c3b2aff81e58251}{x}})\ +\ aMid\ *\ (pixel.\mbox{\hyperlink{unionpoint3D_a4adcb38dc857422d2c3b2aff81e58251}{x}}\ -\/\ source.\mbox{\hyperlink{unionpoint3D_a4adcb38dc857422d2c3b2aff81e58251}{x}})\ -\/\ \mbox{\hyperlink{backprojector_8c_a580fa2a1266bb48c33b07de86029e075}{firstPlane}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21a58833a3110c570fb05130d40c365d1e4}{X}}])\ /\ \mbox{\hyperlink{backprojector_8h_a6f3d6d47811941eb602bf29ca41a2748}{VOXEL\_SIZE\_X}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00261}00261\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ voxelY\ =\ ((source.\mbox{\hyperlink{unionpoint3D_a9b924ec7cf9675336e8785f8339aafde}{y}})\ +\ aMid\ *\ (pixel.\mbox{\hyperlink{unionpoint3D_a9b924ec7cf9675336e8785f8339aafde}{y}}\ -\/\ source.\mbox{\hyperlink{unionpoint3D_a9b924ec7cf9675336e8785f8339aafde}{y}})\ -\/\ \mbox{\hyperlink{backprojector_8c_a580fa2a1266bb48c33b07de86029e075}{firstPlane}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21a5596231eabd6cf29050967d5ac83ad84}{Y}}])\ /\ \mbox{\hyperlink{backprojector_8h_a37617f106adc807eed8d0b793293e736}{VOXEL\_SIZE\_Y}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00262}00262\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ voxelZ\ =\ ((source.\mbox{\hyperlink{unionpoint3D_a10a5c678a54507b798c774c8cee1a0e0}{z}})\ +\ aMid\ *\ (pixel.\mbox{\hyperlink{unionpoint3D_a10a5c678a54507b798c774c8cee1a0e0}{z}}\ -\/\ source.\mbox{\hyperlink{unionpoint3D_a10a5c678a54507b798c774c8cee1a0e0}{z}})\ -\/\ \mbox{\hyperlink{backprojector_8c_a580fa2a1266bb48c33b07de86029e075}{firstPlane}}[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21aa70478ce277ffc322f8e1e3418e07355}{Z}}])\ /\ \mbox{\hyperlink{backprojector_8h_a639cffe85bb2cb95d55e5fe6dedc368d}{VOXEL\_SIZE\_Z}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00263}00263\ \ \ \ \ \ \ \ \ assert(voxelX\ >=\ 0\ \&\&\ voxelY\ >=\ 0\ \&\&\ voxelZ\ >=\ 0);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00264}00264\ \ \ \ \ \ \ \ \ assert(voxelX\ <=\ \mbox{\hyperlink{backprojector_8h_a4735bdd812464f6a3cd734e0cfda1fb1}{N\_VOXELS\_X}}\ \&\&\ voxelY\ <=\ \mbox{\hyperlink{backprojector_8h_ae9d65f60533a93f52d6433c7217e7890}{N\_VOXELS\_Y}}\ \&\&\ voxelZ\ <=\ \mbox{\hyperlink{backprojector_8h_a30ddf7294bb91a0b16a37edc3fbd6fe6}{N\_VOXELS\_Z}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00265}00265\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00266}00266\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ the\ value\ of\ the\ voxel\ given\ the\ value\ of\ the\ pixel\ and\ the}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00267}00267\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ length\ of\ the\ segment\ that\ the\ ray\ intersects\ with\ the\ voxel}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00268}00268\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ voxelAbsorptionValue\ =\ pixelAbsorptionValue\ *\ segmentLength;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00269}00269\ \ \ \ \ \ \ \ \ assert(voxelAbsorptionValue\ >=\ 0);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00270}00270\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ voxelIndex\ =\ voxelX\ +\ voxelY\ *\ \mbox{\hyperlink{backprojector_8h_ae9d65f60533a93f52d6433c7217e7890}{N\_VOXELS\_Y}}\ +\ voxelZ\ *\ \mbox{\hyperlink{backprojector_8h_a30ddf7294bb91a0b16a37edc3fbd6fe6}{N\_VOXELS\_Z}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00271}00271\ \ \ \ \ \ \ \ \ assert(voxelIndex\ >=\ 0\ \&\&\ voxelIndex\ <=\ \mbox{\hyperlink{backprojector_8h_a4735bdd812464f6a3cd734e0cfda1fb1}{N\_VOXELS\_X}}\ *\ \mbox{\hyperlink{backprojector_8h_ae9d65f60533a93f52d6433c7217e7890}{N\_VOXELS\_Y}}\ *\ \mbox{\hyperlink{backprojector_8h_a30ddf7294bb91a0b16a37edc3fbd6fe6}{N\_VOXELS\_Z}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00272}00272\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00273}00273\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ find\ a\ way\ to\ avoid\ using\ atomic\ operations,\ this\ is\ a\ bottleneck}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00274}00274\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#pragma\ omp\ atomic\ update}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00275}00275\ \ \ \ \ \ \ \ \ coefficients[voxelIndex]\ +=\ voxelAbsorptionValue;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00276}00276\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00277}00277\ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00278}00278\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00279}\mbox{\hyperlink{backprojector_8c_a695176076b7a7e5eff55b510ca9293f7}{00279}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{backprojector_8c_a695176076b7a7e5eff55b510ca9293f7}{computeBackProjection}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structprojection}{projection}}*\ \mbox{\hyperlink{structprojection}{projection}},\ \mbox{\hyperlink{structvolume}{volume}}*\ \mbox{\hyperlink{structvolume}{volume}})\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00280}00280\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ arguments\ are\ valid}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00281}00281\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structvolume}{volume}}\ ==\ NULL\ ||\ \mbox{\hyperlink{structprojection}{projection}}\ ==\ NULL)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00282}00282\ \ \ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Invalid\ arguments\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00283}00283\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00284}00284\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00285}00285\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00286}00286\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ source\ point\ of\ this\ projection}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00287}00287\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{unionpoint3D}{point3D}}\ source\ =\ \mbox{\hyperlink{backprojector_8c_a081dea4548f6635b8bcf377386c33226}{getSourcePosition}}(\mbox{\hyperlink{structprojection}{projection}}-\/>\mbox{\hyperlink{structprojection_a3a6f422df5e5f4fa0b268f6530a1f091}{index}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00288}00288\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00289}00289\ \ \ \ \ \textcolor{comment}{//\ Iterate\ through\ every\ pixel\ of\ the\ projection\ image\ and\ calculate\ the}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00290}00290\ \ \ \ \ \textcolor{comment}{//\ coefficients\ of\ the\ voxels\ that\ contribute\ to\ the\ pixel.}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00291}00291\ \ \ \ \ \textcolor{comment}{//\#pragma\ omp\ parallel\ for\ collapse(2)\ schedule(dynamic)\ default(none)\ shared(volume,\ projection,\ source)}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00292}00292\ \ \ \ \ \textcolor{comment}{//\ TODO:\ to\ reduce\ the\ atomic\ operations,\ it\ may\ be\ possible\ to\ offset\ the\ pixel\ processing\ by\ a\ certain\ amount\ *\ thread\_id}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00293}00293\ \ \ \ \ \textcolor{comment}{//\ TODO:\ so\ that\ each\ thread\ shoots\ rays\ at\ different\ pixels,\ this\ could\ reduce\ the\ intersecting\ voxels\ between\ threads}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00294}00294\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ row\ =\ 0;\ row\ <\ \mbox{\hyperlink{structprojection}{projection}}-\/>\mbox{\hyperlink{structprojection_af86af3a77d3a5708622992a0873c4880}{nSidePixels}};\ row++)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00295}00295\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ col\ =\ 0;\ col\ <\ \mbox{\hyperlink{structprojection}{projection}}-\/>\mbox{\hyperlink{structprojection_af86af3a77d3a5708622992a0873c4880}{nSidePixels}};\ col++)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00296}00296\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{unionpoint3D}{point3D}}\ pixel\ =\ \mbox{\hyperlink{backprojector_8c_a44ba7f13100e9b59778aaa69cf1b6237}{getPixelPosition}}(\mbox{\hyperlink{structprojection}{projection}},\ row,\ col);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00297}00297\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{unionray}{ray}}\ \mbox{\hyperlink{unionray}{ray}}\ =\ \{.source=source,\ .pixel=pixel\};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00298}00298\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00299}00299\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ if\ the\ ray\ is\ parallel\ to\ one\ of\ the\ 3D\ space\ axes,}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00300}00300\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ this\ will\ be\ useful\ for\ checks\ later\ in\ the\ Siddon's\ algorithm}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00301}00301\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}\ parallelTo\ =\ \mbox{\hyperlink{backprojector_8c_a96c75e5ea7fdb7390df28cf46090b065}{getParallelAxis}}(\mbox{\hyperlink{unionray}{ray}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00302}00302\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00303}00303\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ array\ will\ contain\ the\ intersection\ points\ of\ the\ ray\ with}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00304}00304\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ planes.\ For\ each\ (3)\ axis\ the\ first\ element\ is\ the\ entry\ point}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00305}00305\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ of\ the\ ray\ into\ the\ first\ plane\ of\ that\ axis\ and\ the\ second\ element}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00306}00306\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ is\ the\ exit\ point\ of\ the\ ray\ from\ the\ last\ plane\ of\ that\ axis.}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00307}00307\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ intersections[3][2];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00308}00308\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{backprojector_8c_ae8384b3bc5b85feb8e1c1a498bbff052}{getSidesIntersections}}(\mbox{\hyperlink{unionray}{ray}},\ parallelTo,\ intersections);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00309}00309\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00310}00310\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Find\ aMin\ and\ aMax\ with\ intersections\ with\ the\ side\ planes}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00311}00311\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ aMin\ =\ \mbox{\hyperlink{backprojector_8c_a0e38a3847dec2b2e3c40870d8b938e19}{getAMin}}(parallelTo,\ intersections);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00312}00312\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ aMax\ =\ \mbox{\hyperlink{backprojector_8c_a5dad3fd7c1d04e6eeca36364d14c1245}{getAMax}}(parallelTo,\ intersections);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00313}00313\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00314}00314\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (aMin\ >=\ aMax)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00315}00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};\ \textcolor{comment}{//\ The\ ray\ doesn't\ intersect\ the\ volume}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00316}00316\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00317}00317\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00318}00318\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00319}00319\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ *\ These\ are\ the\ (min,\ max)\ indices\ of\ the\ planes\ that\ the\ ray\ intersects}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00320}00320\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ *\ in\ the\ x,\ y,\ and\ z\ axes.\ These\ indices\ are\ used\ to\ calculate\ the}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00321}00321\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ *\ coefficients\ of\ the\ voxels\ that\ the\ ray\ intersects.}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00322}00322\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00323}00323\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{unionrange}{range}}\ planesRanges[3];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00324}00324\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{backprojector_8c_abb728284497ed8524b8acc57996e6f0d}{getPlanesRanges}}(\mbox{\hyperlink{unionray}{ray}},\ planesRanges,\ aMin,\ aMax,\ parallelTo);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00325}00325\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00326}00326\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ all\ of\ the\ intersections\ of\ the\ ray\ with\ the\ planes\ of}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00327}00327\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ all\ axes\ and\ merge\ them\ into\ a\ single\ array}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00328}00328\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ a\ volte\ ci\ sono\ indici\ negativi,\ verificare\ perch}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00329}00329\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ aXSize\ =\ fmax(0,\ planesRanges[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21a58833a3110c570fb05130d40c365d1e4}{X}}].max\ -\/\ planesRanges[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21a58833a3110c570fb05130d40c365d1e4}{X}}].min);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00330}00330\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ aYSize\ =\ fmax(0,\ planesRanges[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21a5596231eabd6cf29050967d5ac83ad84}{Y}}].max\ -\/\ planesRanges[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21a5596231eabd6cf29050967d5ac83ad84}{Y}}].min);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00331}00331\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ aZSize\ =\ fmax(0,\ planesRanges[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21aa70478ce277ffc322f8e1e3418e07355}{Z}}].max\ -\/\ planesRanges[\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21aa70478ce277ffc322f8e1e3418e07355}{Z}}].min);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00332}00332\ \ \ \ \ \ \ \ \ \ \ \ \ assert(aXSize\ >=\ 0\ \&\&\ aYSize\ >=\ 0\ \&\&\ aZSize\ >=\ 0);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00333}00333\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ aX[aXSize],\ aY[aYSize],\ aZ[aZSize];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00334}00334\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{backprojector_8c_ae6ca17545d3e55eadcfdfe51b4b5e11c}{getAllIntersections}}(\mbox{\hyperlink{unionray}{ray}},\ planesRanges,\ (\textcolor{keywordtype}{double}*[])\{aX,\ aY,\ aZ\});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00335}00335\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00336}00336\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Merge\ all\ of\ the\ intersections\ into\ a\ single\ sorted\ array}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00337}00337\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ mergedSize\ =\ aXSize\ +\ aYSize\ +\ aZSize;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00338}00338\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ aMerged[mergedSize];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00339}00339\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{backprojector_8c_a6616c0957bffb44f16fb54c48f3f3f05}{mergeIntersections}}(aX,\ aY,\ aZ,\ aXSize,\ aYSize,\ aZSize,\ aMerged);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00340}00340\ \ \ \ \ \ \ \ \ \ \ \ \ assert(\mbox{\hyperlink{backprojector_8c_a973af40d863ad969ee5362184f7656a8}{isArraySorted}}(aMerged,\ mergedSize));}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00341}00341\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00342}00342\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ coefficients\ of\ the\ voxels\ that\ the\ ray\ intersects}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00343}00343\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ finish\ implementing\ this\ properly}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00344}00344\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ pixelAbsorptionValue\ =\ \mbox{\hyperlink{structprojection}{projection}}-\/>\mbox{\hyperlink{structprojection_a778b2f9756b7aba2546c33444f6f6958}{pixels}}[row\ *\ \mbox{\hyperlink{structprojection}{projection}}-\/>\mbox{\hyperlink{structprojection_af86af3a77d3a5708622992a0873c4880}{nSidePixels}}\ +\ col];}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00345}00345\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{backprojector_8c_a0dff3e6286ee3ee9b7e74f9a9ad4f2ec}{computeAbsorption}}(\mbox{\hyperlink{unionray}{ray}},\ aMerged,\ mergedSize,\ pixelAbsorptionValue,\ \mbox{\hyperlink{structvolume}{volume}}-\/>\mbox{\hyperlink{structvolume_a8553556d086a75fc0e97218bafa95279}{coefficients}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00346}00346\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00347}00347\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00348}00348\ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00349}00349\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00350}00350\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00351}\mbox{\hyperlink{backprojector_8c_a0ddf1224851353fc92bfbff6f499fa97}{00351}}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{backprojector_8c_a0ddf1224851353fc92bfbff6f499fa97}{main}}(\textcolor{keywordtype}{int}\ argc,\ \textcolor{keywordtype}{char}*\ argv[])\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00352}00352\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ input\ file\ is\ provided\ either\ as\ an\ argument\ or\ through\ stdin}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00353}00353\ \ \ \ \ \textcolor{keywordflow}{if}\ (argc\ <\ 2\ \&\&\ isatty(fileno(stdin)))\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00354}00354\ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}No\ input\ file\ provided\(\backslash\)n"{}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00355}00355\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00356}00356\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00357}00357\ \ \ \ \ \textcolor{comment}{//\ Open\ the\ input\ file\ or\ use\ stdin}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00358}00358\ \ \ \ \ FILE*\ inputFile\ =\ (argc\ >=\ 2)\ ?\ fopen(argv[1],\ \textcolor{stringliteral}{"{}r"{}})\ :\ stdin;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00359}00359\ \ \ \ \ \textcolor{keywordflow}{if}\ (inputFile\ ==\ NULL)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00360}00360\ \ \ \ \ \ \ \ \ perror(\textcolor{stringliteral}{"{}Error\ opening\ input\ file"{}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00361}00361\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00362}00362\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00363}00363\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00364}00364\ \ \ \ \ \textcolor{comment}{//\ Do\ the\ same\ with\ the\ output\ file}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00365}00365\ \ \ \ \ FILE*\ outputFile\ =\ (argc\ >=\ 3)\ ?\ fopen(argv[2],\ \textcolor{stringliteral}{"{}w"{}})\ :\ stdout;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00366}00366\ \ \ \ \ \textcolor{keywordflow}{if}\ (outputFile\ ==\ NULL)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00367}00367\ \ \ \ \ \ \ \ \ perror(\textcolor{stringliteral}{"{}Error\ opening\ output\ file"{}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00368}00368\ \ \ \ \ \ \ \ \ fclose(outputFile);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00369}00369\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00370}00370\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00371}00371\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00372}00372\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00373}00373\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00374}00374\ \textcolor{comment}{\ \ \ \ *\ This\ struct\ is\ used\ to\ store\ the\ calculated\ coefficients\ of\ the\ voxels}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00375}00375\ \textcolor{comment}{\ \ \ \ *\ using\ the\ backprojection\ algorithm\ starting\ from\ the\ projection\ images}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00376}00376\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00377}00377\ \ \ \ \ \mbox{\hyperlink{structvolume}{volume}}\ \mbox{\hyperlink{structvolume}{volume}}\ =\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00378}00378\ \ \ \ \ \ \ \ \ .nVoxelsX\ =\ \mbox{\hyperlink{backprojector_8h_a4735bdd812464f6a3cd734e0cfda1fb1}{N\_VOXELS\_X}},}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00379}00379\ \ \ \ \ \ \ \ \ .nVoxelsY\ =\ \mbox{\hyperlink{backprojector_8h_ae9d65f60533a93f52d6433c7217e7890}{N\_VOXELS\_Y}},}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00380}00380\ \ \ \ \ \ \ \ \ .nVoxelsZ\ =\ \mbox{\hyperlink{backprojector_8h_a30ddf7294bb91a0b16a37edc3fbd6fe6}{N\_VOXELS\_Z}},}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00381}00381\ \ \ \ \ \ \ \ \ .nPlanesX\ =\ \mbox{\hyperlink{backprojector_8h_a31fa1e7b37667299703791619e8192c7}{N\_PLANES\_X}},}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00382}00382\ \ \ \ \ \ \ \ \ .nPlanesY\ =\ \mbox{\hyperlink{backprojector_8h_a9d8870ca5a668dc86dec40cb7e4a1626}{N\_PLANES\_Y}},}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00383}00383\ \ \ \ \ \ \ \ \ .nPlanesZ\ =\ \mbox{\hyperlink{backprojector_8h_a70b79c1e11466ce6e40be89f54e1f02b}{N\_PLANES\_Z}},}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00384}00384\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ find\ a\ way\ to\ split\ this\ array\ into\ multiple\ parts\ because\ it's\ too\ big\ (1000\string^3)*8\ bytes\ =\ 8GB}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00385}00385\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ a\ possible\ solution\ is\ to\ split\ the\ volume\ into\ chunks\ and\ process\ them\ serially,\ this\ reduces\ the\ memory\ usage\ but\ increases\ the\ runtime}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00386}00386\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ or\ sacrifice\ accuracy\ for\ memory\ by\ using\ float\ instead\ of\ double}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00387}00387\ \ \ \ \ \ \ \ \ .coefficients\ =\ (\textcolor{keywordtype}{double}*)calloc(\mbox{\hyperlink{backprojector_8h_a4735bdd812464f6a3cd734e0cfda1fb1}{N\_VOXELS\_X}}\ *\ \mbox{\hyperlink{backprojector_8h_ae9d65f60533a93f52d6433c7217e7890}{N\_VOXELS\_Y}}\ *\ \mbox{\hyperlink{backprojector_8h_a30ddf7294bb91a0b16a37edc3fbd6fe6}{N\_VOXELS\_Z}},\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}))}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00388}00388\ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00389}00389\ \ \ \ \ \textcolor{comment}{//\ Check\ if\ the\ memory\ was\ allocated\ successfully}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00390}00390\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structvolume}{volume}}.\mbox{\hyperlink{structvolume_a8553556d086a75fc0e97218bafa95279}{coefficients}}\ ==\ NULL)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00391}00391\ \ \ \ \ \ \ \ \ perror(\textcolor{stringliteral}{"{}Error\ allocating\ memory\ for\ the\ volume"{}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00392}00392\ \ \ \ \ \ \ \ \ fclose(inputFile);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00393}00393\ \ \ \ \ \ \ \ \ fclose(outputFile);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00394}00394\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00395}00395\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00396}00396\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00397}00397\ \ \ \ \ \mbox{\hyperlink{backprojector_8c_a6a3745a608949257cc9c8dcd35bb6e72}{initTables}}();}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00398}00398\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00399}00399\ \ \ \ \ \textcolor{keywordtype}{double}\ initialTime\ =\ omp\_get\_wtime();}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00400}00400\ \ \ \ \ \textcolor{keywordtype}{int}\ width,\ height;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00401}00401\ \ \ \ \ \textcolor{keywordtype}{double}\ maxVal;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00402}00402\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00403}00403\ \ \ \ \ \textcolor{comment}{//\ Read\ the\ projection\ images\ from\ the\ file\ and\ compute\ the\ backprojection}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00404}00404\ \textcolor{preprocessor}{\ \ \ \ \#pragma\ omp\ parallel\ for\ default(none)\ shared(inputFile,\ volume,\ width,\ height,\ maxVal,\ stderr)}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00405}00405\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \mbox{\hyperlink{backprojector_8h_a5d8f246b13887f17dd67a8ce2cbdaea3}{N\_THETA}};\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00406}00406\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structprojection}{projection}}\ \mbox{\hyperlink{backprojector_8h_a3e83f6beae9344c4b2248e2b11c64df8}{projection}};}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00407}00407\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ read;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00408}00408\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00409}00409\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ File\ reading\ has\ to\ be\ done\ sequentially}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00410}00410\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \#pragma\ omp\ critical}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00411}00411\ \ \ \ \ \ \ \ \ read\ =\ \mbox{\hyperlink{fileReader_8h_a48badc2c00f56ae85dc9111f0d12b581}{readPGM}}(inputFile,\ \&\mbox{\hyperlink{structprojection}{projection}},\ \&width,\ \&height,\ \&maxVal);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00412}00412\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00413}00413\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ read\ is\ false,\ it\ means\ that\ the\ end\ of\ the\ file\ was\ reached}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00414}00414\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (read)\ \{}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00415}00415\ \ \ \ \ \ \ \ \ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Processing\ projection\ \%d/\%d\(\backslash\)n"{}},\ \mbox{\hyperlink{structprojection}{projection}}.\mbox{\hyperlink{structprojection_a3a6f422df5e5f4fa0b268f6530a1f091}{index}}\ +\ 1,\ \mbox{\hyperlink{backprojector_8h_a5d8f246b13887f17dd67a8ce2cbdaea3}{N\_THETA}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00416}00416\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{backprojector_8c_a695176076b7a7e5eff55b510ca9293f7}{computeBackProjection}}(\&\mbox{\hyperlink{structprojection}{projection}},\ \&\mbox{\hyperlink{structvolume}{volume}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00417}00417\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00418}00418\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00419}00419\ \ \ \ \ \ \ \ \ free(\mbox{\hyperlink{structprojection}{projection}}.\mbox{\hyperlink{structprojection_a778b2f9756b7aba2546c33444f6f6958}{pixels}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00420}00420\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00421}00421\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00422}00422\ \ \ \ \ \textcolor{keywordtype}{double}\ finalTime\ =\ omp\_get\_wtime();}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00423}00423\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Average\ time\ per\ projection:\ \%.3lf\ seconds\(\backslash\)n"{}},\ (finalTime\ -\/\ initialTime)\ /\ \mbox{\hyperlink{backprojector_8h_a5d8f246b13887f17dd67a8ce2cbdaea3}{N\_THETA}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00424}00424\ \ \ \ \ fprintf(stderr,\ \textcolor{stringliteral}{"{}Total\ time\ for\ \%d\ projections:\ \%.3lf\ seconds\(\backslash\)n"{}},\ \mbox{\hyperlink{backprojector_8h_a5d8f246b13887f17dd67a8ce2cbdaea3}{N\_THETA}},\ finalTime\ -\/\ initialTime);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00425}00425\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00426}00426\ \ \ \ \ \mbox{\hyperlink{fileWriter_8h_aa55291cd635a2a4e7c58d4a256c014d6}{writeVolume}}(outputFile,\ \&\mbox{\hyperlink{structvolume}{volume}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00427}00427\ }
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00428}00428\ \ \ \ \ fclose(inputFile);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00429}00429\ \ \ \ \ fclose(outputFile);}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00430}00430\ \ \ \ \ free(\mbox{\hyperlink{structvolume}{volume}}.\mbox{\hyperlink{structvolume_a8553556d086a75fc0e97218bafa95279}{coefficients}});}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00431}00431\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{\Hypertarget{backprojector_8c_source_l00432}00432\ \}}

\end{DoxyCode}
