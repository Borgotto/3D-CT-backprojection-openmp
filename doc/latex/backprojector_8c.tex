\doxysection{backprojector.\+c File Reference}
\hypertarget{backprojector_8c}{}\label{backprojector_8c}\index{backprojector.c@{backprojector.c}}


Implementation of the backprojection algorithm for CT reconstruction.  


{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$stdbool.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$float.\+h$>$}\newline
{\ttfamily \#include $<$assert.\+h$>$}\newline
{\ttfamily \#include $<$unistd.\+h$>$}\newline
{\ttfamily \#include $<$omp.\+h$>$}\newline
{\ttfamily \#include "{}backprojector.\+h"{}}\newline
{\ttfamily \#include "{}file\+Reader.\+h"{}}\newline
{\ttfamily \#include "{}file\+Writer.\+h"{}}\newline
Include dependency graph for backprojector.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{backprojector_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{backprojector_8c_a6a3745a608949257cc9c8dcd35bb6e72}{init\+Tables}} ()
\begin{DoxyCompactList}\small\item\em Initializes the sine and cosine tables, as well as the first\+Plane and last\+Plane arrays. \end{DoxyCompactList}\item 
\mbox{\hyperlink{unionpoint3D}{point3D}} \mbox{\hyperlink{backprojector_8c_a081dea4548f6635b8bcf377386c33226}{get\+Source\+Position}} (const int projection\+Index)
\begin{DoxyCompactList}\small\item\em Calculates the 3D coordinates of the source of the ray given the index of the projection. \end{DoxyCompactList}\item 
\mbox{\hyperlink{unionpoint3D}{point3D}} \mbox{\hyperlink{backprojector_8c_a44ba7f13100e9b59778aaa69cf1b6237}{get\+Pixel\+Position}} (const \mbox{\hyperlink{structprojection}{projection}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{structprojection}{projection}}, const int row, const int col)
\begin{DoxyCompactList}\small\item\em Calculates the 3D coordinates of a pixel of the detector. \end{DoxyCompactList}\item 
\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}} \mbox{\hyperlink{backprojector_8c_a96c75e5ea7fdb7390df28cf46090b065}{get\+Parallel\+Axis}} (const \mbox{\hyperlink{unionray}{ray}} \mbox{\hyperlink{unionray}{ray}})
\begin{DoxyCompactList}\small\item\em Finds which axis is parallel to the ray. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{backprojector_8c_aff0f271395d320a9c9856d4c12e4febb}{get\+Plane\+Position}} (const \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}} \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}, const int index)
\begin{DoxyCompactList}\small\item\em Calculates the position of the plane parallel to the given axis and at the given index. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{backprojector_8c_ae8384b3bc5b85feb8e1c1a498bbff052}{get\+Sides\+Intersections}} (const \mbox{\hyperlink{unionray}{ray}} \mbox{\hyperlink{unionray}{ray}}, const \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}} parallel\+To, double intersections\mbox{[}3\mbox{]}\mbox{[}2\mbox{]})
\begin{DoxyCompactList}\small\item\em Calculates the intersection points of the ray with the planes. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{backprojector_8c_a0e38a3847dec2b2e3c40870d8b938e19}{get\+AMin}} (const \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}} parallel\+To, double intersections\mbox{[}3\mbox{]}\mbox{[}2\mbox{]})
\begin{DoxyCompactList}\small\item\em Finds the minimum intersection point along the given axis. \end{DoxyCompactList}\item 
double \mbox{\hyperlink{backprojector_8c_a5dad3fd7c1d04e6eeca36364d14c1245}{get\+AMax}} (const \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}} parallel\+To, double intersections\mbox{[}3\mbox{]}\mbox{[}2\mbox{]})
\begin{DoxyCompactList}\small\item\em Finds the maximum intersection point along the given axis. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{backprojector_8c_abb728284497ed8524b8acc57996e6f0d}{get\+Planes\+Ranges}} (const \mbox{\hyperlink{unionray}{ray}} \mbox{\hyperlink{unionray}{ray}}, \mbox{\hyperlink{unionrange}{range}} planes\+Indexes\mbox{[}3\mbox{]}, const double a\+Min, const double a\+Max, const \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}} parallel\+To)
\begin{DoxyCompactList}\small\item\em Calculates the ranges of planes that the ray intersects. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{backprojector_8c_ae6ca17545d3e55eadcfdfe51b4b5e11c}{get\+All\+Intersections}} (const \mbox{\hyperlink{unionray}{ray}} \mbox{\hyperlink{unionray}{ray}}, const \mbox{\hyperlink{unionrange}{range}} planes\+Ranges\mbox{[}3\mbox{]}, double \texorpdfstring{$\ast$}{*}a\mbox{[}3\mbox{]})
\begin{DoxyCompactList}\small\item\em Calculates {\itshape all} the intersection points of the ray with the planes. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{backprojector_8c_a6616c0957bffb44f16fb54c48f3f3f05}{merge\+Intersections}} (const double aX\mbox{[}$\,$\mbox{]}, const double aY\mbox{[}$\,$\mbox{]}, const double aZ\mbox{[}$\,$\mbox{]}, const int a\+XSize, const int a\+YSize, const int a\+ZSize, double a\+Merged\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Merges the intersection points of the ray with the planes. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{backprojector_8c_a973af40d863ad969ee5362184f7656a8}{is\+Array\+Sorted}} (const double array\mbox{[}$\,$\mbox{]}, int size)
\begin{DoxyCompactList}\small\item\em Checks if the array is sorted in ascending order. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{backprojector_8c_a0dff3e6286ee3ee9b7e74f9a9ad4f2ec}{compute\+Absorption}} (const \mbox{\hyperlink{unionray}{ray}} \mbox{\hyperlink{unionray}{ray}}, const double a\mbox{[}$\,$\mbox{]}, const int lenA, const double pixel\+Absorption\+Value, double \texorpdfstring{$\ast$}{*}coefficients)
\begin{DoxyCompactList}\small\item\em Computes the absorption value of the voxels intersected by the ray. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{backprojector_8c_a695176076b7a7e5eff55b510ca9293f7}{compute\+Back\+Projection}} (const \mbox{\hyperlink{structprojection}{projection}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{structprojection}{projection}}, \mbox{\hyperlink{structvolume}{volume}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{structvolume}{volume}})
\begin{DoxyCompactList}\small\item\em Computes the backprojection of the projection. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{backprojector_8c_a0ddf1224851353fc92bfbff6f499fa97}{main}} (int argc, char \texorpdfstring{$\ast$}{*}argv\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
long double \mbox{\hyperlink{backprojector_8c_ad60e8e0f9959c12c836ebc81a0a6bb24}{sin\+Table}} \mbox{[}\mbox{\hyperlink{backprojector_8h_a5d8f246b13887f17dd67a8ce2cbdaea3}{N\+\_\+\+THETA}}\mbox{]}
\item 
long double \mbox{\hyperlink{backprojector_8c_a79e6ecbf5ed19cbd5f93888de8cc6656}{cos\+Table}} \mbox{[}\mbox{\hyperlink{backprojector_8h_a5d8f246b13887f17dd67a8ce2cbdaea3}{N\+\_\+\+THETA}}\mbox{]}
\item 
double \mbox{\hyperlink{backprojector_8c_a580fa2a1266bb48c33b07de86029e075}{first\+Plane}} \mbox{[}3\mbox{]}
\item 
double \mbox{\hyperlink{backprojector_8c_ab92865ce9fc376ad61faa449e605310c}{last\+Plane}} \mbox{[}3\mbox{]}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Implementation of the backprojection algorithm for CT reconstruction. 

\begin{DoxyAuthor}{Author}
Emanuele Borghini (\href{mailto:emanuele.borghini@studio.unibo.it}{\texttt{ emanuele.\+borghini@studio.\+unibo.\+it}}) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2024
\end{DoxyDate}


\begin{DoxySeeAlso}{See also}
\doxylink{backprojector_8h}{backprojector.\+h}
\end{DoxySeeAlso}
This file contains the implementation of the backprojection algorithm for reconstructing a 3D object from its 2D projections. The algorithm is based on Siddon\textquotesingle{}s algorithm and is parallelized using Open\+MP. The algorithm reads the projection images from a file and writes the reconstructed 3D object to another file.

The algorithm is divided into several functions, each of which implements an equation from Siddon\textquotesingle{}s algorithm. The main function reads the projection images from the file and computes the backprojection for each of them. 

Definition in file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.



\doxysubsection{Function Documentation}
\Hypertarget{backprojector_8c_a0dff3e6286ee3ee9b7e74f9a9ad4f2ec}\index{backprojector.c@{backprojector.c}!computeAbsorption@{computeAbsorption}}
\index{computeAbsorption@{computeAbsorption}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{computeAbsorption()}{computeAbsorption()}}
{\footnotesize\ttfamily \label{backprojector_8c_a0dff3e6286ee3ee9b7e74f9a9ad4f2ec} 
void compute\+Absorption (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{unionray}{ray}}}]{ray}{, }\item[{const double}]{a}{\mbox{[}$\,$\mbox{]}, }\item[{const int}]{lenA}{, }\item[{const double}]{pixel\+Absorption\+Value}{, }\item[{double \texorpdfstring{$\ast$}{*}}]{coefficients}{}\end{DoxyParamCaption})}



Computes the absorption value of the voxels intersected by the ray. 

The absorption value is computed using the value that is assumed by the pixels and the length of the intersection of the ray with the voxels.


\begin{DoxyParams}{Parameters}
{\em ray} & The ray to compute the absorption for. \\
\hline
{\em a} & The absorption coefficients array. \\
\hline
{\em lenA} & The size of the absorption coefficients array. \\
\hline
{\em pixel\+Absorption\+Value} & The absorption value of the pixel. \\
\hline
{\em coefficients} & The array to store the absorption values. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{backprojector_8c_source_l00241}{241}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

\Hypertarget{backprojector_8c_a695176076b7a7e5eff55b510ca9293f7}\index{backprojector.c@{backprojector.c}!computeBackProjection@{computeBackProjection}}
\index{computeBackProjection@{computeBackProjection}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{computeBackProjection()}{computeBackProjection()}}
{\footnotesize\ttfamily \label{backprojector_8c_a695176076b7a7e5eff55b510ca9293f7} 
void compute\+Back\+Projection (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structprojection}{projection}} \texorpdfstring{$\ast$}{*}}]{projection}{, }\item[{\mbox{\hyperlink{structvolume}{volume}} \texorpdfstring{$\ast$}{*}}]{volume}{}\end{DoxyParamCaption})}



Computes the backprojection of the projection. 

The backprojection is computed by iterating over all the rays and computing the absorption of the voxels intersected by the ray.


\begin{DoxyParams}{Parameters}
{\em projection} & The projection containing the projection pixels values. \\
\hline
{\em volume} & The volume structure containing the absorption coefficients. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{backprojector_8c_source_l00279}{279}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{backprojector_8c_a695176076b7a7e5eff55b510ca9293f7_cgraph}
\end{center}
\end{figure}
\Hypertarget{backprojector_8c_ae6ca17545d3e55eadcfdfe51b4b5e11c}\index{backprojector.c@{backprojector.c}!getAllIntersections@{getAllIntersections}}
\index{getAllIntersections@{getAllIntersections}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{getAllIntersections()}{getAllIntersections()}}
{\footnotesize\ttfamily \label{backprojector_8c_ae6ca17545d3e55eadcfdfe51b4b5e11c} 
void get\+All\+Intersections (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{unionray}{ray}}}]{ray}{, }\item[{const \mbox{\hyperlink{unionrange}{range}}}]{planes\+Ranges}{\mbox{[}3\mbox{]}, }\item[{double \texorpdfstring{$\ast$}{*}}]{a}{\mbox{[}3\mbox{]}}\end{DoxyParamCaption})}



Calculates {\itshape all} the intersection points of the ray with the planes. 

For each axis, the array contains the intersection points of the ray with the planes of that axis.


\begin{DoxyParams}{Parameters}
{\em ray} & The ray to calculate intersections for. \\
\hline
{\em planes\+Ranges} & The ranges of planes that the ray intersects. \\
\hline
{\em a} & The array to store the intersection points. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{backprojector_8c_source_l00167}{167}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=322pt]{backprojector_8c_ae6ca17545d3e55eadcfdfe51b4b5e11c_cgraph}
\end{center}
\end{figure}
\Hypertarget{backprojector_8c_a5dad3fd7c1d04e6eeca36364d14c1245}\index{backprojector.c@{backprojector.c}!getAMax@{getAMax}}
\index{getAMax@{getAMax}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{getAMax()}{getAMax()}}
{\footnotesize\ttfamily \label{backprojector_8c_a5dad3fd7c1d04e6eeca36364d14c1245} 
double get\+AMax (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}}]{parallel\+To}{, }\item[{double}]{intersections}{\mbox{[}3\mbox{]}\mbox{[}2\mbox{]}}\end{DoxyParamCaption})}



Finds the maximum intersection point along the given axis. 


\begin{DoxyParams}{Parameters}
{\em parallel\+To} & The axis parallel to the ray. \\
\hline
{\em intersections} & The array of intersection points. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The maximum intersection point. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{backprojector_8c_source_l00136}{136}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

\Hypertarget{backprojector_8c_a0e38a3847dec2b2e3c40870d8b938e19}\index{backprojector.c@{backprojector.c}!getAMin@{getAMin}}
\index{getAMin@{getAMin}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{getAMin()}{getAMin()}}
{\footnotesize\ttfamily \label{backprojector_8c_a0e38a3847dec2b2e3c40870d8b938e19} 
double get\+AMin (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}}]{parallel\+To}{, }\item[{double}]{intersections}{\mbox{[}3\mbox{]}\mbox{[}2\mbox{]}}\end{DoxyParamCaption})}



Finds the minimum intersection point along the given axis. 


\begin{DoxyParams}{Parameters}
{\em parallel\+To} & The axis parallel to the ray. \\
\hline
{\em intersections} & The array of intersection points. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The minimum intersection point. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{backprojector_8c_source_l00123}{123}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

\Hypertarget{backprojector_8c_a96c75e5ea7fdb7390df28cf46090b065}\index{backprojector.c@{backprojector.c}!getParallelAxis@{getParallelAxis}}
\index{getParallelAxis@{getParallelAxis}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{getParallelAxis()}{getParallelAxis()}}
{\footnotesize\ttfamily \label{backprojector_8c_a96c75e5ea7fdb7390df28cf46090b065} 
\mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}} get\+Parallel\+Axis (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{unionray}{ray}}}]{ray}{}\end{DoxyParamCaption})}



Finds which axis is parallel to the ray. 

If the ray is not parallel to any axis, it returns axis\+::\+NONE.


\begin{DoxyParams}{Parameters}
{\em ray} & The ray to check. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The axis that is parallel to the ray, or axis\+::\+NONE if none. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{backprojector_8c_source_l00087}{87}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

\Hypertarget{backprojector_8c_a44ba7f13100e9b59778aaa69cf1b6237}\index{backprojector.c@{backprojector.c}!getPixelPosition@{getPixelPosition}}
\index{getPixelPosition@{getPixelPosition}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{getPixelPosition()}{getPixelPosition()}}
{\footnotesize\ttfamily \label{backprojector_8c_a44ba7f13100e9b59778aaa69cf1b6237} 
\mbox{\hyperlink{unionpoint3D}{point3D}} get\+Pixel\+Position (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{structprojection}{projection}} \texorpdfstring{$\ast$}{*}}]{projection}{, }\item[{const int}]{row}{, }\item[{const int}]{col}{}\end{DoxyParamCaption})}



Calculates the 3D coordinates of a pixel of the detector. 

The pixel is located at a distance of DOD from the volumetric center of the object.


\begin{DoxyParams}{Parameters}
{\em projection} & The projection data. \\
\hline
{\em row} & The row index of the pixel. \\
\hline
{\em col} & The column index of the pixel. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The 3D coordinates of the pixel. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{backprojector_8c_source_l00073}{73}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

\Hypertarget{backprojector_8c_aff0f271395d320a9c9856d4c12e4febb}\index{backprojector.c@{backprojector.c}!getPlanePosition@{getPlanePosition}}
\index{getPlanePosition@{getPlanePosition}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{getPlanePosition()}{getPlanePosition()}}
{\footnotesize\ttfamily \label{backprojector_8c_aff0f271395d320a9c9856d4c12e4febb} 
double get\+Plane\+Position (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}}]{axis}{, }\item[{const int}]{index}{}\end{DoxyParamCaption})}



Calculates the position of the plane parallel to the given axis and at the given index. 

The position is calculated out of the total number of planes in that axis {\ttfamily N\+\_\+\+PLANES\mbox{[}axis\mbox{]}}.


\begin{DoxyParams}{Parameters}
{\em axis} & The axis parallel to the plane. \\
\hline
{\em index} & The index of the plane. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The position of the plane. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{backprojector_8c_source_l00100}{100}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

\Hypertarget{backprojector_8c_abb728284497ed8524b8acc57996e6f0d}\index{backprojector.c@{backprojector.c}!getPlanesRanges@{getPlanesRanges}}
\index{getPlanesRanges@{getPlanesRanges}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{getPlanesRanges()}{getPlanesRanges()}}
{\footnotesize\ttfamily \label{backprojector_8c_abb728284497ed8524b8acc57996e6f0d} 
void get\+Planes\+Ranges (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{unionray}{ray}}}]{ray}{, }\item[{\mbox{\hyperlink{unionrange}{range}}}]{planes\+Indexes}{\mbox{[}3\mbox{]}, }\item[{const double}]{a\+Min}{, }\item[{const double}]{a\+Max}{, }\item[{const \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}}]{parallel\+To}{}\end{DoxyParamCaption})}



Calculates the ranges of planes that the ray intersects. 


\begin{DoxyParams}{Parameters}
{\em ray} & The ray to calculate ranges for. \\
\hline
{\em planes\+Indexes} & The array to store the ranges of planes. \\
\hline
{\em a\+Min} & The minimum intersection point. \\
\hline
{\em a\+Max} & The maximum intersection point. \\
\hline
{\em parallel\+To} & The axis parallel to the ray. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{backprojector_8c_source_l00149}{149}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

\Hypertarget{backprojector_8c_ae8384b3bc5b85feb8e1c1a498bbff052}\index{backprojector.c@{backprojector.c}!getSidesIntersections@{getSidesIntersections}}
\index{getSidesIntersections@{getSidesIntersections}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{getSidesIntersections()}{getSidesIntersections()}}
{\footnotesize\ttfamily \label{backprojector_8c_ae8384b3bc5b85feb8e1c1a498bbff052} 
void get\+Sides\+Intersections (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{unionray}{ray}}}]{ray}{, }\item[{const \mbox{\hyperlink{backprojector_8h_accc088009d44c521706aa98d6387ee21}{axis}}}]{parallel\+To}{, }\item[{double}]{intersections}{\mbox{[}3\mbox{]}\mbox{[}2\mbox{]}}\end{DoxyParamCaption})}



Calculates the intersection points of the ray with the planes. 

For each axis, the first element is the entry point of the ray into the first plane of that axis, and the second element is the exit point of the ray from the last plane of that axis.


\begin{DoxyParams}{Parameters}
{\em ray} & The ray to calculate intersections for. \\
\hline
{\em parallel\+To} & The axis parallel to the ray. \\
\hline
{\em intersections} & The array to store the intersection points. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{backprojector_8c_source_l00108}{108}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

\Hypertarget{backprojector_8c_a081dea4548f6635b8bcf377386c33226}\index{backprojector.c@{backprojector.c}!getSourcePosition@{getSourcePosition}}
\index{getSourcePosition@{getSourcePosition}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{getSourcePosition()}{getSourcePosition()}}
{\footnotesize\ttfamily \label{backprojector_8c_a081dea4548f6635b8bcf377386c33226} 
\mbox{\hyperlink{unionpoint3D}{point3D}} get\+Source\+Position (\begin{DoxyParamCaption}\item[{const int}]{projection\+Index}{}\end{DoxyParamCaption})}



Calculates the 3D coordinates of the source of the ray given the index of the projection. 

The source is located at a distance of DOS from the volumetric center of the object. The angle is derived from the index and the step angle.


\begin{DoxyParams}{Parameters}
{\em projection\+Index} & The index of the projection. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The 3D coordinates of the source. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{backprojector_8c_source_l00065}{65}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

\Hypertarget{backprojector_8c_a6a3745a608949257cc9c8dcd35bb6e72}\index{backprojector.c@{backprojector.c}!initTables@{initTables}}
\index{initTables@{initTables}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{initTables()}{initTables()}}
{\footnotesize\ttfamily \label{backprojector_8c_a6a3745a608949257cc9c8dcd35bb6e72} 
void init\+Tables (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Initializes the sine and cosine tables, as well as the first\+Plane and last\+Plane arrays. 

These values are complex to calculate each time, so they are precomputed and cached to optimize performance during backprojection operations. 

Definition at line \mbox{\hyperlink{backprojector_8c_source_l00044}{44}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

\Hypertarget{backprojector_8c_a973af40d863ad969ee5362184f7656a8}\index{backprojector.c@{backprojector.c}!isArraySorted@{isArraySorted}}
\index{isArraySorted@{isArraySorted}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{isArraySorted()}{isArraySorted()}}
{\footnotesize\ttfamily \label{backprojector_8c_a973af40d863ad969ee5362184f7656a8} 
bool is\+Array\+Sorted (\begin{DoxyParamCaption}\item[{const double}]{array}{\mbox{[}$\,$\mbox{]}, }\item[{int}]{size}{}\end{DoxyParamCaption})}



Checks if the array is sorted in ascending order. 


\begin{DoxyParams}{Parameters}
{\em array} & The array to check. \\
\hline
{\em size} & The size of the array. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if the array is sorted, false otherwise. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{backprojector_8c_source_l00232}{232}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

\Hypertarget{backprojector_8c_a0ddf1224851353fc92bfbff6f499fa97}\index{backprojector.c@{backprojector.c}!main@{main}}
\index{main@{main}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily \label{backprojector_8c_a0ddf1224851353fc92bfbff6f499fa97} 
int main (\begin{DoxyParamCaption}\item[{int}]{argc}{, }\item[{char \texorpdfstring{$\ast$}{*}}]{argv}{\mbox{[}$\,$\mbox{]}}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{backprojector_8c_source_l00351}{351}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{backprojector_8c_a0ddf1224851353fc92bfbff6f499fa97_cgraph}
\end{center}
\end{figure}
\Hypertarget{backprojector_8c_a6616c0957bffb44f16fb54c48f3f3f05}\index{backprojector.c@{backprojector.c}!mergeIntersections@{mergeIntersections}}
\index{mergeIntersections@{mergeIntersections}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{mergeIntersections()}{mergeIntersections()}}
{\footnotesize\ttfamily \label{backprojector_8c_a6616c0957bffb44f16fb54c48f3f3f05} 
void merge\+Intersections (\begin{DoxyParamCaption}\item[{const double}]{aX}{\mbox{[}$\,$\mbox{]}, }\item[{const double}]{aY}{\mbox{[}$\,$\mbox{]}, }\item[{const double}]{aZ}{\mbox{[}$\,$\mbox{]}, }\item[{const int}]{a\+XSize}{, }\item[{const int}]{a\+YSize}{, }\item[{const int}]{a\+ZSize}{, }\item[{double}]{a\+Merged}{\mbox{[}$\,$\mbox{]}}\end{DoxyParamCaption})}



Merges the intersection points of the ray with the planes. 

The merged array contains the intersection points of the ray with all the planes.


\begin{DoxyParams}{Parameters}
{\em aX} & The intersection points of the ray with the planes of the x-\/axis. \\
\hline
{\em aY} & The intersection points of the ray with the planes of the y-\/axis. \\
\hline
{\em aZ} & The intersection points of the ray with the planes of the z-\/axis. \\
\hline
{\em a\+XSize} & The size of the aX array. \\
\hline
{\em a\+YSize} & The size of the aY array. \\
\hline
{\em a\+ZSize} & The size of the aZ array. \\
\hline
{\em a\+Merged} & The array to store the merged intersection points. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{backprojector_8c_source_l00194}{194}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.



\doxysubsection{Variable Documentation}
\Hypertarget{backprojector_8c_a79e6ecbf5ed19cbd5f93888de8cc6656}\index{backprojector.c@{backprojector.c}!cosTable@{cosTable}}
\index{cosTable@{cosTable}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{cosTable}{cosTable}}
{\footnotesize\ttfamily \label{backprojector_8c_a79e6ecbf5ed19cbd5f93888de8cc6656} 
long double cos\+Table\mbox{[}\mbox{\hyperlink{backprojector_8h_a5d8f246b13887f17dd67a8ce2cbdaea3}{N\+\_\+\+THETA}}\mbox{]}}



Definition at line \mbox{\hyperlink{backprojector_8c_source_l00039}{39}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

\Hypertarget{backprojector_8c_a580fa2a1266bb48c33b07de86029e075}\index{backprojector.c@{backprojector.c}!firstPlane@{firstPlane}}
\index{firstPlane@{firstPlane}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{firstPlane}{firstPlane}}
{\footnotesize\ttfamily \label{backprojector_8c_a580fa2a1266bb48c33b07de86029e075} 
double first\+Plane\mbox{[}3\mbox{]}}



Definition at line \mbox{\hyperlink{backprojector_8c_source_l00042}{42}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

\Hypertarget{backprojector_8c_ab92865ce9fc376ad61faa449e605310c}\index{backprojector.c@{backprojector.c}!lastPlane@{lastPlane}}
\index{lastPlane@{lastPlane}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{lastPlane}{lastPlane}}
{\footnotesize\ttfamily \label{backprojector_8c_ab92865ce9fc376ad61faa449e605310c} 
double last\+Plane\mbox{[}3\mbox{]}}



Definition at line \mbox{\hyperlink{backprojector_8c_source_l00042}{42}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

\Hypertarget{backprojector_8c_ad60e8e0f9959c12c836ebc81a0a6bb24}\index{backprojector.c@{backprojector.c}!sinTable@{sinTable}}
\index{sinTable@{sinTable}!backprojector.c@{backprojector.c}}
\doxysubsubsection{\texorpdfstring{sinTable}{sinTable}}
{\footnotesize\ttfamily \label{backprojector_8c_ad60e8e0f9959c12c836ebc81a0a6bb24} 
long double sin\+Table\mbox{[}\mbox{\hyperlink{backprojector_8h_a5d8f246b13887f17dd67a8ce2cbdaea3}{N\+\_\+\+THETA}}\mbox{]}}



Definition at line \mbox{\hyperlink{backprojector_8c_source_l00039}{39}} of file \mbox{\hyperlink{backprojector_8c_source}{backprojector.\+c}}.

