<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>3D-CT-backprojection-openmp: backprojector.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<script type="text/javascript" src="darkmode_toggle.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">3D-CT-backprojection-openmp
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search',true);
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('backprojector_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">backprojector.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of the backprojection algorithm for CT reconstruction.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;omp.h&gt;</code><br />
<code>#include &quot;<a class="el" href="backprojector_8h_source.html">backprojector.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fileReader_8h_source.html">fileReader.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fileWriter_8h_source.html">fileWriter.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for backprojector.c:</div>
<div class="dyncontent">
<div class="center"><img src="backprojector_8c__incl.png" border="0" usemap="#abackprojector_8c" alt=""/></div>
<map name="abackprojector_8c" id="abackprojector_8c">
<area shape="rect" title="Implementation of the backprojection algorithm for CT reconstruction." alt="" coords="510,5,631,31"/>
<area shape="rect" title=" " alt="" coords="5,79,72,104"/>
<area shape="poly" title=" " alt="" coords="510,27,325,46,207,62,86,81,85,76,207,56,324,41,510,22"/>
<area shape="rect" title=" " alt="" coords="97,79,167,104"/>
<area shape="poly" title=" " alt="" coords="510,30,364,50,181,81,180,76,364,45,509,24"/>
<area shape="rect" title=" " alt="" coords="192,79,275,104"/>
<area shape="poly" title=" " alt="" coords="516,33,289,81,288,76,515,28"/>
<area shape="rect" title=" " alt="" coords="299,79,370,104"/>
<area shape="poly" title=" " alt="" coords="534,33,384,78,382,73,532,28"/>
<area shape="rect" title=" " alt="" coords="394,79,465,104"/>
<area shape="poly" title=" " alt="" coords="549,33,466,75,463,70,547,28"/>
<area shape="rect" title=" " alt="" coords="489,79,557,104"/>
<area shape="poly" title=" " alt="" coords="565,33,540,69,536,66,561,30"/>
<area shape="rect" title=" " alt="" coords="581,79,656,104"/>
<area shape="poly" title=" " alt="" coords="581,30,606,66,601,69,576,33"/>
<area shape="rect" title=" " alt="" coords="680,79,744,104"/>
<area shape="poly" title=" " alt="" coords="595,28,678,70,676,75,592,33"/>
<area shape="rect" title=" " alt="" coords="769,79,831,104"/>
<area shape="poly" title=" " alt="" coords="608,28,756,74,754,79,607,33"/>
<area shape="rect" href="backprojector_8h.html" title="Header file for the backprojector module." alt="" coords="856,79,979,104"/>
<area shape="poly" title=" " alt="" coords="627,28,848,73,847,78,626,33"/>
<area shape="rect" href="fileReader_8h.html" title="fileReader module" alt="" coords="1003,79,1101,104"/>
<area shape="poly" title=" " alt="" coords="632,24,989,76,989,81,631,30"/>
<area shape="rect" href="fileWriter_8h.html" title="fileWriter module" alt="" coords="1125,79,1219,104"/>
<area shape="poly" title=" " alt="" coords="632,22,840,42,1112,76,1111,81,840,47,631,27"/>
</map>
</div>
</div>
<p><a href="backprojector_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6a3745a608949257cc9c8dcd35bb6e72" id="r_a6a3745a608949257cc9c8dcd35bb6e72"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6a3745a608949257cc9c8dcd35bb6e72">initTables</a> ()</td></tr>
<tr class="memdesc:a6a3745a608949257cc9c8dcd35bb6e72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the sine and cosine tables, as well as the firstPlane and lastPlane arrays.  <br /></td></tr>
<tr class="separator:a6a3745a608949257cc9c8dcd35bb6e72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a081dea4548f6635b8bcf377386c33226" id="r_a081dea4548f6635b8bcf377386c33226"><td class="memItemLeft" align="right" valign="top"><a class="el" href="unionpoint3D.html">point3D</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a081dea4548f6635b8bcf377386c33226">getSourcePosition</a> (const int projectionIndex)</td></tr>
<tr class="memdesc:a081dea4548f6635b8bcf377386c33226"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the 3D coordinates of the source of the ray given the index of the projection.  <br /></td></tr>
<tr class="separator:a081dea4548f6635b8bcf377386c33226"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44ba7f13100e9b59778aaa69cf1b6237" id="r_a44ba7f13100e9b59778aaa69cf1b6237"><td class="memItemLeft" align="right" valign="top"><a class="el" href="unionpoint3D.html">point3D</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a44ba7f13100e9b59778aaa69cf1b6237">getPixelPosition</a> (const <a class="el" href="structprojection.html">projection</a> *<a class="el" href="structprojection.html">projection</a>, const int row, const int col)</td></tr>
<tr class="memdesc:a44ba7f13100e9b59778aaa69cf1b6237"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the 3D coordinates of a pixel of the detector.  <br /></td></tr>
<tr class="separator:a44ba7f13100e9b59778aaa69cf1b6237"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96c75e5ea7fdb7390df28cf46090b065" id="r_a96c75e5ea7fdb7390df28cf46090b065"><td class="memItemLeft" align="right" valign="top"><a class="el" href="backprojector_8h.html#accc088009d44c521706aa98d6387ee21">axis</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a96c75e5ea7fdb7390df28cf46090b065">getParallelAxis</a> (const <a class="el" href="structray.html">ray</a> <a class="el" href="structray.html">ray</a>)</td></tr>
<tr class="memdesc:a96c75e5ea7fdb7390df28cf46090b065"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds which axis is parallel to the ray.  <br /></td></tr>
<tr class="separator:a96c75e5ea7fdb7390df28cf46090b065"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff0f271395d320a9c9856d4c12e4febb" id="r_aff0f271395d320a9c9856d4c12e4febb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aff0f271395d320a9c9856d4c12e4febb">getPlanePosition</a> (const <a class="el" href="backprojector_8h.html#accc088009d44c521706aa98d6387ee21">axis</a> <a class="el" href="backprojector_8h.html#accc088009d44c521706aa98d6387ee21">axis</a>, const int index)</td></tr>
<tr class="memdesc:aff0f271395d320a9c9856d4c12e4febb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the position of the plane parallel to the given axis and at the given index.  <br /></td></tr>
<tr class="separator:aff0f271395d320a9c9856d4c12e4febb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8384b3bc5b85feb8e1c1a498bbff052" id="r_ae8384b3bc5b85feb8e1c1a498bbff052"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae8384b3bc5b85feb8e1c1a498bbff052">getSidesIntersections</a> (const <a class="el" href="structray.html">ray</a> <a class="el" href="structray.html">ray</a>, const <a class="el" href="backprojector_8h.html#accc088009d44c521706aa98d6387ee21">axis</a> parallelTo, double intersections[3][2])</td></tr>
<tr class="memdesc:ae8384b3bc5b85feb8e1c1a498bbff052"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the intersection points of the ray with the planes.  <br /></td></tr>
<tr class="separator:ae8384b3bc5b85feb8e1c1a498bbff052"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e38a3847dec2b2e3c40870d8b938e19" id="r_a0e38a3847dec2b2e3c40870d8b938e19"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0e38a3847dec2b2e3c40870d8b938e19">getAMin</a> (const <a class="el" href="backprojector_8h.html#accc088009d44c521706aa98d6387ee21">axis</a> parallelTo, double intersections[3][2])</td></tr>
<tr class="memdesc:a0e38a3847dec2b2e3c40870d8b938e19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the minimum intersection point along the given axis.  <br /></td></tr>
<tr class="separator:a0e38a3847dec2b2e3c40870d8b938e19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dad3fd7c1d04e6eeca36364d14c1245" id="r_a5dad3fd7c1d04e6eeca36364d14c1245"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5dad3fd7c1d04e6eeca36364d14c1245">getAMax</a> (const <a class="el" href="backprojector_8h.html#accc088009d44c521706aa98d6387ee21">axis</a> parallelTo, double intersections[3][2])</td></tr>
<tr class="memdesc:a5dad3fd7c1d04e6eeca36364d14c1245"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the maximum intersection point along the given axis.  <br /></td></tr>
<tr class="separator:a5dad3fd7c1d04e6eeca36364d14c1245"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9445bd05a2be753cb2c4c44c5aee654f" id="r_a9445bd05a2be753cb2c4c44c5aee654f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9445bd05a2be753cb2c4c44c5aee654f">getPlanesRanges</a> (const <a class="el" href="structray.html">ray</a> <a class="el" href="structray.html">ray</a>, <a class="el" href="structrange.html">range</a> planesRanges[3], const double aMin, const double aMax)</td></tr>
<tr class="memdesc:a9445bd05a2be753cb2c4c44c5aee654f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the ranges of planes that the ray intersects.  <br /></td></tr>
<tr class="separator:a9445bd05a2be753cb2c4c44c5aee654f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6ca17545d3e55eadcfdfe51b4b5e11c" id="r_ae6ca17545d3e55eadcfdfe51b4b5e11c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae6ca17545d3e55eadcfdfe51b4b5e11c">getAllIntersections</a> (const <a class="el" href="structray.html">ray</a> <a class="el" href="structray.html">ray</a>, const <a class="el" href="structrange.html">range</a> planesRanges[3], double *a[3])</td></tr>
<tr class="memdesc:ae6ca17545d3e55eadcfdfe51b4b5e11c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates <em>all</em> the intersection points of the ray with the planes.  <br /></td></tr>
<tr class="separator:ae6ca17545d3e55eadcfdfe51b4b5e11c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6616c0957bffb44f16fb54c48f3f3f05" id="r_a6616c0957bffb44f16fb54c48f3f3f05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6616c0957bffb44f16fb54c48f3f3f05">mergeIntersections</a> (const double aX[], const double aY[], const double aZ[], const int aXSize, const int aYSize, const int aZSize, double aMerged[])</td></tr>
<tr class="memdesc:a6616c0957bffb44f16fb54c48f3f3f05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Merges the intersection points of the ray with the planes.  <br /></td></tr>
<tr class="separator:a6616c0957bffb44f16fb54c48f3f3f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeed0117a7aa23163c82f9b64d019b82" id="r_adeed0117a7aa23163c82f9b64d019b82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adeed0117a7aa23163c82f9b64d019b82">computeAbsorption</a> (const <a class="el" href="structray.html">ray</a> <a class="el" href="structray.html">ray</a>, const double a[], const int lenA, const <a class="el" href="structvolume.html">volume</a> *<a class="el" href="structvolume.html">volume</a>, const <a class="el" href="structprojection.html">projection</a> *<a class="el" href="structprojection.html">projection</a>, const int pixelIndex)</td></tr>
<tr class="memdesc:adeed0117a7aa23163c82f9b64d019b82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the absorption value of the voxels intersected by the ray.  <br /></td></tr>
<tr class="separator:adeed0117a7aa23163c82f9b64d019b82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a695176076b7a7e5eff55b510ca9293f7" id="r_a695176076b7a7e5eff55b510ca9293f7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a695176076b7a7e5eff55b510ca9293f7">computeBackProjection</a> (const <a class="el" href="structprojection.html">projection</a> *<a class="el" href="structprojection.html">projection</a>, <a class="el" href="structvolume.html">volume</a> *<a class="el" href="structvolume.html">volume</a>)</td></tr>
<tr class="memdesc:a695176076b7a7e5eff55b510ca9293f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the backprojection of the projection.  <br /></td></tr>
<tr class="separator:a695176076b7a7e5eff55b510ca9293f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97" id="r_a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad60e8e0f9959c12c836ebc81a0a6bb24" id="r_ad60e8e0f9959c12c836ebc81a0a6bb24"><td class="memItemLeft" align="right" valign="top">long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad60e8e0f9959c12c836ebc81a0a6bb24">sinTable</a> [<a class="el" href="backprojector_8h.html#a5d8f246b13887f17dd67a8ce2cbdaea3">N_THETA</a>]</td></tr>
<tr class="separator:ad60e8e0f9959c12c836ebc81a0a6bb24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79e6ecbf5ed19cbd5f93888de8cc6656" id="r_a79e6ecbf5ed19cbd5f93888de8cc6656"><td class="memItemLeft" align="right" valign="top">long double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a79e6ecbf5ed19cbd5f93888de8cc6656">cosTable</a> [<a class="el" href="backprojector_8h.html#a5d8f246b13887f17dd67a8ce2cbdaea3">N_THETA</a>]</td></tr>
<tr class="separator:a79e6ecbf5ed19cbd5f93888de8cc6656"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a580fa2a1266bb48c33b07de86029e075" id="r_a580fa2a1266bb48c33b07de86029e075"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a580fa2a1266bb48c33b07de86029e075">firstPlane</a> [3]</td></tr>
<tr class="separator:a580fa2a1266bb48c33b07de86029e075"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab92865ce9fc376ad61faa449e605310c" id="r_ab92865ce9fc376ad61faa449e605310c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab92865ce9fc376ad61faa449e605310c">lastPlane</a> [3]</td></tr>
<tr class="separator:ab92865ce9fc376ad61faa449e605310c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of the backprojection algorithm for CT reconstruction. </p>
<dl class="section author"><dt>Author</dt><dd>Emanuele Borghini (<a href="#" onclick="location.href='mai'+'lto:'+'ema'+'nu'+'ele'+'.b'+'org'+'hi'+'ni@'+'st'+'udi'+'o.'+'uni'+'bo'+'.it'; return false;">emanu<span class="obfuscator">.nosp@m.</span>ele.<span class="obfuscator">.nosp@m.</span>borgh<span class="obfuscator">.nosp@m.</span>ini@<span class="obfuscator">.nosp@m.</span>studi<span class="obfuscator">.nosp@m.</span>o.un<span class="obfuscator">.nosp@m.</span>ibo.i<span class="obfuscator">.nosp@m.</span>t</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2024</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="backprojector_8h.html" title="Header file for the backprojector module.">backprojector.h</a></dd></dl>
<p>This file contains the implementation of the backprojection algorithm for reconstructing a 3D object from its 2D projections. The algorithm is based on Siddon's algorithm and is parallelized using OpenMP. The algorithm reads the projection images from a file and writes the reconstructed 3D object to another file.</p>
<p>The algorithm is divided into several functions, each of which implements an equation from Siddon's algorithm. The main function reads the projection images from the file and computes the backprojection for each of them. </p>

<p class="definition">Definition in file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="adeed0117a7aa23163c82f9b64d019b82" name="adeed0117a7aa23163c82f9b64d019b82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeed0117a7aa23163c82f9b64d019b82">&#9670;&#160;</a></span>computeAbsorption()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void computeAbsorption </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structray.html">ray</a></td>          <td class="paramname"><span class="paramname"><em>ray</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double</td>          <td class="paramname"><span class="paramname"><em>a</em></span>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int</td>          <td class="paramname"><span class="paramname"><em>lenA</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structvolume.html">volume</a> *</td>          <td class="paramname"><span class="paramname"><em>volume</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structprojection.html">projection</a> *</td>          <td class="paramname"><span class="paramname"><em>projection</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int</td>          <td class="paramname"><span class="paramname"><em>pixelIndex</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the absorption value of the voxels intersected by the ray. </p>
<dl class="section note"><dt>Note</dt><dd>Siddon's algorithm, equation 10</dd></dl>
<p>\(
l(m) = d_{12} * (\alpha(m) - \alpha(m-1)) \quad (m = 1, \ldots, N)
\)</p>
<dl class="section note"><dt>Note</dt><dd>Siddon's algorithm, equation 11</dd></dl>
<p>\(
d_{12} = \sqrt{(X_2 - X_1)^2 + (Y_2 - Y_1)^2 + (Z_2 - Z_1)^2}
\)</p>
<dl class="section note"><dt>Note</dt><dd>Siddon's algorithm, equation 12</dd></dl>
<p>\(
i(m) = 1 + (X_1 + \alpha_{mid} * (X_2 - X_1) - X_{plane}(0)) / d_x \\
j(m) = 1 + (Y_1 + \alpha_{mid} * (Y_2 - Y_1) - Y_{plane}(0)) / d_y \\
k(m) = 1 + (Z_1 + \alpha_{mid} * (Z_2 - Z_1) - Z_{plane}(0)) / d_z
\)</p>
<dl class="section note"><dt>Note</dt><dd>Siddon's algorithm, equation 13</dd></dl>
<p>\(
\alpha_{mid} = (\alpha(m) + \alpha(m-1)) / 2
\)</p>
<p>The absorption value is computed using the value that is assumed by the pixels and the length of the intersection of the ray with the voxels.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ray</td><td>The ray to compute the absorption for. </td></tr>
    <tr><td class="paramname">a</td><td>The absorption coefficients array. </td></tr>
    <tr><td class="paramname">lenA</td><td>The size of the absorption coefficients array. </td></tr>
    <tr><td class="paramname">volume</td><td>The volume structure containing the absorption coefficients. </td></tr>
    <tr><td class="paramname">projection</td><td>The projection data. </td></tr>
    <tr><td class="paramname">pixelIndex</td><td>The index of the pixel to get the absorption value for. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00240">240</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
<a id="a695176076b7a7e5eff55b510ca9293f7" name="a695176076b7a7e5eff55b510ca9293f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a695176076b7a7e5eff55b510ca9293f7">&#9670;&#160;</a></span>computeBackProjection()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void computeBackProjection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structprojection.html">projection</a> *</td>          <td class="paramname"><span class="paramname"><em>projection</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structvolume.html">volume</a> *</td>          <td class="paramname"><span class="paramname"><em>volume</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the backprojection of the projection. </p>
<dl class="section note"><dt>Note</dt><dd>Siddon's algorithm, equation 9</dd></dl>
<p>\(
N = (i_{max} - i_{min} + 1) + (j_{max} - j_{min} + 1) + (k_{max} - k_{min} + 1)
\)</p>
<dl class="section note"><dt>Note</dt><dd>Siddon's algorithm, equation 8</dd></dl>
<p>\(
\{\alpha\} = \{\alpha_{min}, \text{merge}(\alpha_x, \alpha_y, \alpha_z), \alpha_{max}\} \\
\qquad = \{\alpha(0), \ldots, \alpha(N)\}
\)</p>
<p>The backprojection is computed by iterating over all the rays and computing the absorption of the voxels intersected by the ray.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">projection</td><td>The projection containing the projection pixels values. </td></tr>
    <tr><td class="paramname">volume</td><td>The volume structure containing the absorption coefficients. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00288">288</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backprojector_8c_a695176076b7a7e5eff55b510ca9293f7_cgraph.png" border="0" usemap="#abackprojector_8c_a695176076b7a7e5eff55b510ca9293f7_cgraph" alt=""/></div>
<map name="abackprojector_8c_a695176076b7a7e5eff55b510ca9293f7_cgraph" id="abackprojector_8c_a695176076b7a7e5eff55b510ca9293f7_cgraph">
<area shape="rect" title="Computes the backprojection of the projection." alt="" coords="5,228,181,253"/>
<area shape="rect" href="backprojector_8c.html#adeed0117a7aa23163c82f9b64d019b82" title="Computes the absorption value of the voxels intersected by the ray." alt="" coords="236,5,385,31"/>
<area shape="poly" title=" " alt="" coords="97,227,114,190,142,139,180,86,202,61,228,40,236,35,239,39,231,44,206,65,184,89,146,142,119,192,102,229"/>
<area shape="rect" href="backprojector_8c.html#ae6ca17545d3e55eadcfdfe51b4b5e11c" title="Calculates all the intersection points of the ray with the planes." alt="" coords="239,55,383,80"/>
<area shape="poly" title=" " alt="" coords="101,226,149,161,185,122,228,89,239,83,241,88,231,94,189,126,153,164,105,229"/>
<area shape="rect" href="backprojector_8c.html#a5dad3fd7c1d04e6eeca36364d14c1245" title="Finds the maximum intersection point along the given axis." alt="" coords="271,104,351,129"/>
<area shape="poly" title=" " alt="" coords="107,226,158,183,192,159,228,138,257,127,259,132,231,143,195,164,161,188,110,230"/>
<area shape="rect" href="backprojector_8c.html#a0e38a3847dec2b2e3c40870d8b938e19" title="Finds the minimum intersection point along the given axis." alt="" coords="273,153,349,179"/>
<area shape="poly" title=" " alt="" coords="126,225,228,187,259,178,260,183,230,193,127,230"/>
<area shape="rect" href="backprojector_8c.html#a96c75e5ea7fdb7390df28cf46090b065" title="Finds which axis is parallel to the ray." alt="" coords="251,203,370,228"/>
<area shape="poly" title=" " alt="" coords="181,228,237,221,238,226,182,233"/>
<area shape="rect" href="backprojector_8c.html#a44ba7f13100e9b59778aaa69cf1b6237" title="Calculates the 3D coordinates of a pixel of the detector." alt="" coords="247,252,374,277"/>
<area shape="poly" title=" " alt="" coords="182,248,233,253,233,259,181,253"/>
<area shape="rect" href="backprojector_8c.html#a9445bd05a2be753cb2c4c44c5aee654f" title="Calculates the ranges of planes that the ray intersects." alt="" coords="243,301,378,327"/>
<area shape="poly" title=" " alt="" coords="130,251,230,286,256,295,254,300,228,291,129,256"/>
<area shape="rect" href="backprojector_8c.html#ae8384b3bc5b85feb8e1c1a498bbff052" title="Calculates the intersection points of the ray with the planes." alt="" coords="229,351,392,376"/>
<area shape="poly" title=" " alt="" coords="111,251,162,292,231,336,249,344,247,348,228,340,159,297,107,256"/>
<area shape="rect" href="backprojector_8c.html#a081dea4548f6635b8bcf377386c33226" title="Calculates the 3D coordinates of the source of the ray given the index of the projection." alt="" coords="241,400,380,425"/>
<area shape="poly" title=" " alt="" coords="105,252,154,316,190,353,231,385,244,392,242,397,228,390,186,357,150,319,101,255"/>
<area shape="rect" href="backprojector_8c.html#a6616c0957bffb44f16fb54c48f3f3f05" title="Merges the intersection points of the ray with the planes." alt="" coords="237,449,385,475"/>
<area shape="poly" title=" " alt="" coords="102,252,119,288,146,337,184,390,206,414,231,435,241,441,239,446,228,439,203,417,180,393,142,340,114,291,97,254"/>
<area shape="rect" href="backprojector_8c.html#aff0f271395d320a9c9856d4c12e4febb" title="Calculates the position of the plane parallel to the given axis and at the given index." alt="" coords="440,55,571,80"/>
<area shape="poly" title=" " alt="" coords="383,65,426,65,426,70,383,70"/>
</map>
</div>

</div>
</div>
<a id="ae6ca17545d3e55eadcfdfe51b4b5e11c" name="ae6ca17545d3e55eadcfdfe51b4b5e11c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6ca17545d3e55eadcfdfe51b4b5e11c">&#9670;&#160;</a></span>getAllIntersections()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getAllIntersections </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structray.html">ray</a></td>          <td class="paramname"><span class="paramname"><em>ray</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structrange.html">range</a></td>          <td class="paramname"><span class="paramname"><em>planesRanges</em></span>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>a</em></span>[3]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates <em>all</em> the intersection points of the ray with the planes. </p>
<dl class="section note"><dt>Note</dt><dd>Siddon's algorithm, equation 7</dd></dl>
<p>\(
\text{If}(X_2-X_1) \gt 0: \\
\quad \{\alpha_x\} = \{\alpha_x(i_{min}), \ldots, \alpha_x(i_{max})\} \\
\text{If}(X_2-X_1) \lt 0: \\
\quad \{\alpha_x\} = \{\alpha_x(i_{max}), \ldots, \alpha_x(i_{min})\} \\

\text{where:} \\
\alpha_x(i) = (X_{plane}(i) - X_1) / (X_2 - X_1) \\

\text{or recursively:} \\
\alpha_x(i) = \alpha_x(i-1) + d_x / (X_2 - X_1) \\
\)</p>
<p>Similar equations are used for the Y and Z axes.</p>
<p>For each axis, the array contains the intersection points of the ray with the planes of that axis.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ray</td><td>The ray to calculate intersections for. </td></tr>
    <tr><td class="paramname">planesRanges</td><td>The ranges of planes that the ray intersects. </td></tr>
    <tr><td class="paramname">a</td><td>The array to store the intersection points. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00161">161</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backprojector_8c_ae6ca17545d3e55eadcfdfe51b4b5e11c_cgraph.png" border="0" usemap="#abackprojector_8c_ae6ca17545d3e55eadcfdfe51b4b5e11c_cgraph" alt=""/></div>
<map name="abackprojector_8c_ae6ca17545d3e55eadcfdfe51b4b5e11c_cgraph" id="abackprojector_8c_ae6ca17545d3e55eadcfdfe51b4b5e11c_cgraph">
<area shape="rect" title="Calculates all the intersection points of the ray with the planes." alt="" coords="5,5,149,31"/>
<area shape="rect" href="backprojector_8c.html#aff0f271395d320a9c9856d4c12e4febb" title="Calculates the position of the plane parallel to the given axis and at the given index." alt="" coords="197,5,328,31"/>
<area shape="poly" title=" " alt="" coords="150,15,184,15,184,21,150,21"/>
</map>
</div>

</div>
</div>
<a id="a5dad3fd7c1d04e6eeca36364d14c1245" name="a5dad3fd7c1d04e6eeca36364d14c1245"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dad3fd7c1d04e6eeca36364d14c1245">&#9670;&#160;</a></span>getAMax()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double getAMax </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="backprojector_8h.html#accc088009d44c521706aa98d6387ee21">axis</a></td>          <td class="paramname"><span class="paramname"><em>parallelTo</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>intersections</em></span>[3][2]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the maximum intersection point along the given axis. </p>
<dl class="section note"><dt>Note</dt><dd>Siddon's algorithm, equation 5</dd></dl>
<p>\(
\alpha_{max} = \min\{1, \max\{\alpha_x(0), \alpha_x(N_x)\}, \max\{\alpha_y(0), \alpha_y(N_y)\}, \max\{\alpha_z(0), \alpha_z(N_z)\}\}
\)</p>
<p>Similar equations are used for the Y and Z axes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parallelTo</td><td>The axis parallel to the ray. </td></tr>
    <tr><td class="paramname">intersections</td><td>The array of intersection points. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The maximum intersection point. </dd></dl>

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00131">131</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
<a id="a0e38a3847dec2b2e3c40870d8b938e19" name="a0e38a3847dec2b2e3c40870d8b938e19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e38a3847dec2b2e3c40870d8b938e19">&#9670;&#160;</a></span>getAMin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double getAMin </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="backprojector_8h.html#accc088009d44c521706aa98d6387ee21">axis</a></td>          <td class="paramname"><span class="paramname"><em>parallelTo</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>intersections</em></span>[3][2]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the minimum intersection point along the given axis. </p>
<dl class="section note"><dt>Note</dt><dd>Siddon's algorithm, equation 5</dd></dl>
<p>\(
\alpha_{min} = \max\{0, \min\{\alpha_x(0), \alpha_x(N_x)\}, \min\{\alpha_y(0), \alpha_y(N_y)\}, \min\{\alpha_z(0), \alpha_z(N_z)\}\}
\)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parallelTo</td><td>The axis parallel to the ray. </td></tr>
    <tr><td class="paramname">intersections</td><td>The array of intersection points. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The minimum intersection point. </dd></dl>

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00118">118</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
<a id="a96c75e5ea7fdb7390df28cf46090b065" name="a96c75e5ea7fdb7390df28cf46090b065"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96c75e5ea7fdb7390df28cf46090b065">&#9670;&#160;</a></span>getParallelAxis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="backprojector_8h.html#accc088009d44c521706aa98d6387ee21">axis</a> getParallelAxis </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structray.html">ray</a></td>          <td class="paramname"><span class="paramname"><em>ray</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds which axis is parallel to the ray. </p>
<p>If the ray is not parallel to any axis, it returns axis::NONE.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ray</td><td>The ray to check. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The axis that is parallel to the ray, or axis::NONE if none. </dd></dl>

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00085">85</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
<a id="a44ba7f13100e9b59778aaa69cf1b6237" name="a44ba7f13100e9b59778aaa69cf1b6237"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44ba7f13100e9b59778aaa69cf1b6237">&#9670;&#160;</a></span>getPixelPosition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="unionpoint3D.html">point3D</a> getPixelPosition </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structprojection.html">projection</a> *</td>          <td class="paramname"><span class="paramname"><em>projection</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int</td>          <td class="paramname"><span class="paramname"><em>row</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int</td>          <td class="paramname"><span class="paramname"><em>col</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the 3D coordinates of a pixel of the detector. </p>
<p>The pixel is located at a distance of DOD from the volumetric center of the object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">projection</td><td>The projection data. </td></tr>
    <tr><td class="paramname">row</td><td>The row index of the pixel. </td></tr>
    <tr><td class="paramname">col</td><td>The column index of the pixel. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The 3D coordinates of the pixel. </dd></dl>

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00071">71</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
<a id="aff0f271395d320a9c9856d4c12e4febb" name="aff0f271395d320a9c9856d4c12e4febb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff0f271395d320a9c9856d4c12e4febb">&#9670;&#160;</a></span>getPlanePosition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double getPlanePosition </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="backprojector_8h.html#accc088009d44c521706aa98d6387ee21">axis</a></td>          <td class="paramname"><span class="paramname"><em>axis</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int</td>          <td class="paramname"><span class="paramname"><em>index</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the position of the plane parallel to the given axis and at the given index. </p>
<dl class="section note"><dt>Note</dt><dd>Siddon's algorithm, equation 3</dd></dl>
<p>\(
X_{plane}(i) = X_{plane}(0) + i * d_x \quad (i = 0, \ldots, N_x) \\
Y_{plane}(j) = Y_{plane}(0) + j * d_y \quad (j = 0, \ldots, N_y) \\
Z_{plane}(k) = Z_{plane}(0) + k * d_z \quad (k = 0, \ldots, N_z)
\)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">axis</td><td>The axis parallel to the plane. </td></tr>
    <tr><td class="paramname">index</td><td>The index of the plane. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The position of the plane. </dd></dl>

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00098">98</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
<a id="a9445bd05a2be753cb2c4c44c5aee654f" name="a9445bd05a2be753cb2c4c44c5aee654f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9445bd05a2be753cb2c4c44c5aee654f">&#9670;&#160;</a></span>getPlanesRanges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getPlanesRanges </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structray.html">ray</a></td>          <td class="paramname"><span class="paramname"><em>ray</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrange.html">range</a></td>          <td class="paramname"><span class="paramname"><em>planesIndexes</em></span>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double</td>          <td class="paramname"><span class="paramname"><em>aMin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double</td>          <td class="paramname"><span class="paramname"><em>aMax</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the ranges of planes that the ray intersects. </p>
<dl class="section note"><dt>Note</dt><dd>Siddon's algorithm, equation 6</dd></dl>
<p>\(
\text{If}(X_2-X_1) \geq 0: \\
\quad i_{min} = N_x - (X_{plane}(N_x) - \alpha_{min} * (X_2 - X_1) - X_1) / d_x \\
\quad i_{max} = 1 + (X_1 + \alpha_{max} * (X_2 - X_1) - X_{plane}(0)) / d_x \\
\text{If}(X_2-X_1) \leq 0: \\
\quad i_{min} = N_x - (X_{plane}(N_x) - \alpha_{max} * (X_2 - X_1) - X_1) / d_x \\
\quad i_{max} = 1 + (X_1 + \alpha_{min} * (X_2 - X_1) - X_{plane}(0)) / d_x
\)</p>
<p>Similar equations are used for j and k indexes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ray</td><td>The ray to calculate ranges for. </td></tr>
    <tr><td class="paramname">planesIndexes</td><td>The array to store the ranges of planes. </td></tr>
    <tr><td class="paramname">aMin</td><td>The minimum intersection point. </td></tr>
    <tr><td class="paramname">aMax</td><td>The maximum intersection point. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00144">144</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
<a id="ae8384b3bc5b85feb8e1c1a498bbff052" name="ae8384b3bc5b85feb8e1c1a498bbff052"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8384b3bc5b85feb8e1c1a498bbff052">&#9670;&#160;</a></span>getSidesIntersections()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getSidesIntersections </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structray.html">ray</a></td>          <td class="paramname"><span class="paramname"><em>ray</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="backprojector_8h.html#accc088009d44c521706aa98d6387ee21">axis</a></td>          <td class="paramname"><span class="paramname"><em>parallelTo</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>intersections</em></span>[3][2]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the intersection points of the ray with the planes. </p>
<dl class="section note"><dt>Note</dt><dd>Siddon's algorithm, equation 4</dd></dl>
<p>For each axis, the first element is the entry point of the ray into the first plane of that axis, and the second element is the exit point of the ray from the last plane of that axis.</p>
<p>\(
\text{If}(X_2-X_1) \neq 0: \\
\quad\alpha_x(0) = (X_{plane}(0) - X_1) / (X_2 - X_1) \\
\quad\alpha_x(N_x) = (X_{plane}(N_x) - X_1) / (X_2 - X_1)
\)</p>
<p>If the ray is parallel to the axis, the intersection points are undefined.</p>
<p>Similar equations are used for the Y and Z axes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ray</td><td>The ray to calculate intersections for. </td></tr>
    <tr><td class="paramname">parallelTo</td><td>The axis parallel to the ray. </td></tr>
    <tr><td class="paramname">intersections</td><td>The array to store the intersection points. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00103">103</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
<a id="a081dea4548f6635b8bcf377386c33226" name="a081dea4548f6635b8bcf377386c33226"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a081dea4548f6635b8bcf377386c33226">&#9670;&#160;</a></span>getSourcePosition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="unionpoint3D.html">point3D</a> getSourcePosition </td>
          <td>(</td>
          <td class="paramtype">const int</td>          <td class="paramname"><span class="paramname"><em>projectionIndex</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the 3D coordinates of the source of the ray given the index of the projection. </p>
<p>The source is located at a distance of DOS from the volumetric center of the object. The angle is derived from the index and the step angle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">projectionIndex</td><td>The index of the projection. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The 3D coordinates of the source. </dd></dl>

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00063">63</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
<a id="a6a3745a608949257cc9c8dcd35bb6e72" name="a6a3745a608949257cc9c8dcd35bb6e72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a3745a608949257cc9c8dcd35bb6e72">&#9670;&#160;</a></span>initTables()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initTables </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the sine and cosine tables, as well as the firstPlane and lastPlane arrays. </p>
<p>These values are complex to calculate each time, so they are precomputed and cached to optimize performance during backprojection operations. </p>

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00047">47</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
<a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>argc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *</td>          <td class="paramname"><span class="paramname"><em>argv</em></span>[]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00376">376</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="backprojector_8c_a0ddf1224851353fc92bfbff6f499fa97_cgraph.png" border="0" usemap="#abackprojector_8c_a0ddf1224851353fc92bfbff6f499fa97_cgraph" alt=""/></div>
<map name="abackprojector_8c_a0ddf1224851353fc92bfbff6f499fa97_cgraph" id="abackprojector_8c_a0ddf1224851353fc92bfbff6f499fa97_cgraph">
<area shape="rect" title=" " alt="" coords="5,351,60,376"/>
<area shape="rect" href="backprojector_8c.html#a695176076b7a7e5eff55b510ca9293f7" title="Computes the backprojection of the projection." alt="" coords="108,227,284,252"/>
<area shape="poly" title=" " alt="" coords="38,349,63,306,83,282,106,261,116,255,119,260,110,265,87,285,68,309,42,352"/>
<area shape="rect" href="backprojector_8c.html#a6a3745a608949257cc9c8dcd35bb6e72" title="Initializes the sine and cosine tables, as well as the firstPlane and lastPlane arrays." alt="" coords="154,276,238,301"/>
<area shape="poly" title=" " alt="" coords="48,348,75,329,107,310,140,298,142,303,109,315,77,333,51,353"/>
<area shape="rect" href="fileReader_8h.html#a8e542e7e29a221f4ededa2c04b7a8216" title="Read a DAT file containing CT projections." alt="" coords="125,325,267,351"/>
<area shape="poly" title=" " alt="" coords="60,357,111,349,111,354,61,362"/>
<area shape="rect" href="fileReader_8h.html#a403f55e2c17353b9a5e358a582ab8e31" title="Read a PGM file containing CT projections." alt="" coords="123,375,269,400"/>
<area shape="poly" title=" " alt="" coords="61,365,109,372,108,377,60,370"/>
<area shape="rect" href="fileWriter_8h.html#a25c018aea36b43f77e3f14af4ba7a6f6" title="Write a 3D volume of voxels to a file." alt="" coords="125,424,267,449"/>
<area shape="poly" title=" " alt="" coords="52,374,78,392,109,409,130,417,128,422,107,414,76,396,49,378"/>
<area shape="rect" href="fileWriter_8h.html#a0fc77da284b460f4ab96af666194aa42" title="Write a 3D volume of voxels to a file." alt="" coords="129,473,263,499"/>
<area shape="poly" title=" " alt="" coords="43,375,68,416,87,439,110,458,122,466,119,470,106,463,83,443,64,419,38,378"/>
<area shape="rect" href="backprojector_8c.html#adeed0117a7aa23163c82f9b64d019b82" title="Computes the absorption value of the voxels intersected by the ray." alt="" coords="339,5,488,31"/>
<area shape="poly" title=" " alt="" coords="200,225,217,189,244,139,282,86,305,61,330,40,338,35,341,39,334,44,309,65,286,89,249,142,221,191,205,228"/>
<area shape="rect" href="backprojector_8c.html#ae6ca17545d3e55eadcfdfe51b4b5e11c" title="Calculates all the intersection points of the ray with the planes." alt="" coords="341,55,485,80"/>
<area shape="poly" title=" " alt="" coords="203,225,252,160,288,122,331,89,342,83,344,88,333,94,292,126,256,164,208,228"/>
<area shape="rect" href="backprojector_8c.html#a5dad3fd7c1d04e6eeca36364d14c1245" title="Finds the maximum intersection point along the given axis." alt="" coords="373,104,453,129"/>
<area shape="poly" title=" " alt="" coords="210,225,261,183,295,159,331,138,359,127,361,132,333,143,297,164,264,187,213,229"/>
<area shape="rect" href="backprojector_8c.html#a0e38a3847dec2b2e3c40870d8b938e19" title="Finds the minimum intersection point along the given axis." alt="" coords="375,153,451,179"/>
<area shape="poly" title=" " alt="" coords="229,224,331,187,362,178,363,183,333,193,231,229"/>
<area shape="rect" href="backprojector_8c.html#a96c75e5ea7fdb7390df28cf46090b065" title="Finds which axis is parallel to the ray." alt="" coords="354,203,473,228"/>
<area shape="poly" title=" " alt="" coords="284,227,340,221,341,226,284,232"/>
<area shape="rect" href="backprojector_8c.html#a44ba7f13100e9b59778aaa69cf1b6237" title="Calculates the 3D coordinates of a pixel of the detector." alt="" coords="350,252,477,277"/>
<area shape="poly" title=" " alt="" coords="284,247,336,253,336,258,284,252"/>
<area shape="rect" href="backprojector_8c.html#a9445bd05a2be753cb2c4c44c5aee654f" title="Calculates the ranges of planes that the ray intersects." alt="" coords="346,301,481,327"/>
<area shape="poly" title=" " alt="" coords="251,249,285,261,333,286,355,295,353,300,331,291,283,266,249,255"/>
<area shape="rect" href="backprojector_8c.html#ae8384b3bc5b85feb8e1c1a498bbff052" title="Calculates the intersection points of the ray with the planes." alt="" coords="332,351,495,376"/>
<area shape="poly" title=" " alt="" coords="265,250,286,261,303,280,311,299,318,318,334,336,344,343,341,347,330,340,313,321,306,301,298,283,282,265,262,254"/>
<area shape="rect" href="backprojector_8c.html#a081dea4548f6635b8bcf377386c33226" title="Calculates the 3D coordinates of the source of the ray given the index of the projection." alt="" coords="344,400,483,425"/>
<area shape="poly" title=" " alt="" coords="269,250,286,261,299,277,306,293,311,325,315,356,322,371,334,385,341,391,338,395,330,389,317,373,310,357,306,325,301,295,295,280,282,265,266,254"/>
<area shape="rect" href="backprojector_8c.html#a6616c0957bffb44f16fb54c48f3f3f05" title="Merges the intersection points of the ray with the planes." alt="" coords="339,449,487,475"/>
<area shape="poly" title=" " alt="" coords="270,250,286,261,302,283,310,306,311,350,312,393,319,414,334,435,340,440,336,444,330,438,314,416,306,394,306,350,305,307,298,286,282,265,267,254"/>
<area shape="rect" href="backprojector_8c.html#aff0f271395d320a9c9856d4c12e4febb" title="Calculates the position of the plane parallel to the given axis and at the given index." alt="" coords="543,55,673,80"/>
<area shape="poly" title=" " alt="" coords="486,65,529,65,529,70,486,70"/>
</map>
</div>

</div>
</div>
<a id="a6616c0957bffb44f16fb54c48f3f3f05" name="a6616c0957bffb44f16fb54c48f3f3f05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6616c0957bffb44f16fb54c48f3f3f05">&#9670;&#160;</a></span>mergeIntersections()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mergeIntersections </td>
          <td>(</td>
          <td class="paramtype">const double</td>          <td class="paramname"><span class="paramname"><em>aX</em></span>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double</td>          <td class="paramname"><span class="paramname"><em>aY</em></span>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double</td>          <td class="paramname"><span class="paramname"><em>aZ</em></span>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int</td>          <td class="paramname"><span class="paramname"><em>aXSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int</td>          <td class="paramname"><span class="paramname"><em>aYSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int</td>          <td class="paramname"><span class="paramname"><em>aZSize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>aMerged</em></span>[]&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Merges the intersection points of the ray with the planes. </p>
<dl class="section note"><dt>Note</dt><dd>Siddon's algorithm, equation 8</dd></dl>
<p>\(
\{\alpha\} = \{\alpha_{min}, \text{merge}(\alpha_x, \alpha_y, \alpha_z), \alpha_{max}\} \\
\qquad = \{\alpha(0), \ldots, \alpha(N)\} \\
\text{where:} \\
N = (i_{max} - i_{min} + 1) + (j_{max} - j_{min} + 1) + (k_{max} - k_{min} + 1)
\)</p>
<p>The merged array contains the intersection points of the ray with all the planes, sorted in ascending order.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aX</td><td>The intersection points of the ray with the planes of the x-axis. </td></tr>
    <tr><td class="paramname">aY</td><td>The intersection points of the ray with the planes of the y-axis. </td></tr>
    <tr><td class="paramname">aZ</td><td>The intersection points of the ray with the planes of the z-axis. </td></tr>
    <tr><td class="paramname">aXSize</td><td>The size of the aX array. </td></tr>
    <tr><td class="paramname">aYSize</td><td>The size of the aY array. </td></tr>
    <tr><td class="paramname">aZSize</td><td>The size of the aZ array. </td></tr>
    <tr><td class="paramname">aMerged</td><td>The array to store the merged intersection points. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00191">191</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a79e6ecbf5ed19cbd5f93888de8cc6656" name="a79e6ecbf5ed19cbd5f93888de8cc6656"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79e6ecbf5ed19cbd5f93888de8cc6656">&#9670;&#160;</a></span>cosTable</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long double cosTable[<a class="el" href="backprojector_8h.html#a5d8f246b13887f17dd67a8ce2cbdaea3">N_THETA</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00042">42</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
<a id="a580fa2a1266bb48c33b07de86029e075" name="a580fa2a1266bb48c33b07de86029e075"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a580fa2a1266bb48c33b07de86029e075">&#9670;&#160;</a></span>firstPlane</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double firstPlane[3]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00045">45</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
<a id="ab92865ce9fc376ad61faa449e605310c" name="ab92865ce9fc376ad61faa449e605310c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab92865ce9fc376ad61faa449e605310c">&#9670;&#160;</a></span>lastPlane</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double lastPlane[3]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00045">45</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
<a id="ad60e8e0f9959c12c836ebc81a0a6bb24" name="ad60e8e0f9959c12c836ebc81a0a6bb24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad60e8e0f9959c12c836ebc81a0a6bb24">&#9670;&#160;</a></span>sinTable</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long double sinTable[<a class="el" href="backprojector_8h.html#a5d8f246b13887f17dd67a8ce2cbdaea3">N_THETA</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="backprojector_8c_source.html#l00042">42</a> of file <a class="el" href="backprojector_8c_source.html">backprojector.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="backprojector_8c.html">backprojector.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
